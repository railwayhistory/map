#
#
let wanham = path("path.de.2200");
let wanham.har = path("path.de.2200.har");

with detail = [4, 5] {
    # ...

    with link = "line.de.2200" {
        track(:first :cat :flip :tight, wanham[:spr + 1sw, :buc.a] << 1dt);
        track(:first :cat :tight, wanham[:spr + 1sw, :buc.a] >> 1dt);
    }
    with link = "line.de.1283" {
        track(:first :cat :tight, wanham[:spr + 1sw, :buc.a]);
    }

    with link = "point.de.Buchholz-Nordheide" {
        # Str. 2200 L
        track(:first:station :cat,
                wanham[:buc.a, :buc + 0.5sw] << 1dt
            ..  wanham[:buc.f - 100m, :buc.f] << 0.5dt
        );

        # Str. 1283
        track(:first:station :cat,
                wanham[:buc.a, :buc + 0.5sw]
            ..  wanham[:buc.f - 100m, :buc.f - 99m] << 0.5dt
        );
        track(:first:station :cat,
                wanham[:buc + 0.49sw, :buc + 0.5sw]
            ..  wanham[:buc.f - 100m, :buc.f - 99m] >> 0.5dt
        );

        # Str. 2200 R
        track(:first:station :cat,
                wanham[:buc.a, :buc + 0.5sw] >> 1dt
            ..  wanham[:buc.f - 100m, :buc.f] >> 0.5dt
        );

        # 1712
        track(:first:station,
                wanham[:fsol, :buc.bhf - 400m] >> 2dt
            ..  wanham[:buc.bhf, :buc] >> 4dt
        );

        # 1300
        track(:second:station,
                wanham[:fbre, :buc.bhf - 400m] >> 3dt
            ..  wanham[:buc.bhf, :buc] >> 5dt
        );

        # 1280
        track(:first:station :double :cat,
                path("path.de.1280.buc")[:buc, :buc.f] >> 4.5dt
        );


        marker(:de.bf :right, wanham[:buc] >> 1dt);
        station(:top, wanham[:buc - 2sw] << 3dt,
            hbox(:center:base,
                span(:bold, "Buchholz "),
                span(:regular, "(Nordh)")
            ),
            hbox(:center:top,
                vbox(:right:top,
                    span(:removed, "1151: "),
                    span(:open, "1280: "),
                    span(:open, "1283: "),
                    span(:removed, "1300: "),
                    span(:open, "1712: "),
                    span(:open, "2200: ")
                ),
                vbox(:right:top,
                    span(:removed, "268,"),
                    span(:open, "0,"),
                    span(:open, "323,"),
                    span(:removed, "92,"),
                    span(:open, "133,"),
                    span(:open, "323,")
                ),
                vbox(:left:top,
                    span(:removed, "31"),
                    span(:open, "00"),
                    span(:open, "20"),
                    span(:removed, "94"),
                    span(:open, "06"),
                    span(:open, "20")
                )
            )
        );
    }


    with link = "line.de.2200" {
        track(:first :double :cat, wanham[:buc.f, :kle - 1sw]);
        with layer = 1 line_badge(:open, wanham[:buc.f + 1.2km], "2200");
    }


    with link = "point.de.B端nsen" {
        with layer = -1 marker(:de.bk :removed :left, wanham[:bun] << 0.5dt);
        station(:left :removed, wanham[:bun - 0.4sw] << 0.5dt << 1.2sw,
            "B端nsen", "325,92"
        );
    }

    
    with link = "point.de.Klecken" {
        track(:first:station :double :cat, wanham[:kle - 1sw, :kle + 1sw]);
        marker(:de.hp :left, wanham[:kle] << 0.5dt);
        with layer = -1 marker(:de.bf :removed :left, wanham[:kle] << 0.5dt);
        station(:left, wanham[:kle - 0.4sw] << 0.5dt << 1.4sw,
            "Klecken", "329,10"
        );
    }


    with link = "line.de.2200" {
        track(:first :double :cat, wanham[:kle + 1sw, :hit - 1sw]);
    }


    with link = "point.de.Eddelsen" {
        with layer = -1 marker(:de.bk :removed :left, wanham[:edd] << 0.5dt);
        station(:left :removed, wanham[:edd - 0.4sw] << 0.5dt << 1.2sw,
            "Eddelsen", "331,42"
        );
    }


    with link = "point.de.Hittfeld" {
        track(:first:station :double :cat,
                wanham[:hit - 1sw, :hit + 30m + 1sw]
        );
        marker(:de.hp :right, wanham[:hit] >> 0.5dt);
        with layer = -1 marker(:de.bf :removed :right,
            wanham[:hit + 30m] >> 0.5dt
        );
        station(:right :left_align, wanham[:hit - 0.3sw] >> 0.5dt >> 1.6sw,
            "Hittfeld",
            hbox(:left:base,
                "334,52 ",
                span(:removed, "(334,55)")
            )
        );
    }


    with link = "line.de.2200" {
        with layer = 4 track(:first :double :cat,
                wanham[:hit + 30m + 1sw, :hga.a]
        );
        with layer = 5 line_badge(:open, wanham[:hga.a - 1.2km], "2200");
    }


    with link = "point.de.Gl端singen-Harburg" {
        with layer = -1 marker(:de.bk :removed :right, wanham[:glu] >> 0.5dt);
        station(:right :removed, wanham[:glu - 0.2sw] >> 0.5dt >> 1.6sw,
            "Gl端singen", "337,60"
        );
    }

    # point.de.Hamburg-Harburg - point.de.Hamburg-Hbf: D4/D5 getrennt.
}

