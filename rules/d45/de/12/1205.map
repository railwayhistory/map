# DE 1205.  Tönning - Bad St Peter-Ording
#
let tonpeo = path("path.de.1205");

with detail = [4, 5] {
    with link = "point.de.Tönning" {
        # Gleis 1
        with layer = -1 track(:station :closed,
                tonpeo[:ton.a + 39m, :ton.a + 40m] << 1dt
            --  tonpeo[:ton.a + 80m, :ton - 100m]
        );
        track(:second:station, tonpeo[:ton - 100m, :ton.f]);

        # Gleis 2
        with layer = -1 track(:station :closed,
                tonpeo[:ton.a, :ton - 100m] << 1dt
        );
        track(:station,
                tonpeo[:ton - 100m, :ahus - 80m] << 1dt
            --  tonpeo[:ahus - 20m, :ahus - 19m]
        );

        # Ausfahrt Husum
        track(:second:station,
                tonpeo[:ahus]
            --  tonpeo[:ahus + 60m] >> 1dt
        );

        marker(:de.bf :right, tonpeo[:ahus - 40m - 0.5sw]);
        label(tonpeo[:ton],
            hbox(:top:right,
                vbox(:center:top,
                    span(:medium :bold, "Tönning"),
                    hbox(:center:top :xsmall,
                        vbox(:right:top,
                            span(:open, "1204: "),
                            span(:open, "1205: ")
                        ),
                        vbox(:right:top,
                            span(:open, "21,"),
                            span(:open, "21,")
                        ),
                        vbox(:left:top,
                            span(:open, "19 "),
                            span(:open, "08 ")
                        ),
                        vbox(:right:top,
                            span(:removed, "("),
                            span(:removed, "(")
                        ),
                        vbox(:right:top,
                            span(:removed, "191,"),
                            span(:removed, "0,")
                        ),
                        vbox(:left:top,
                            span(:removed, "56)"),
                            span(:removed, "00)")
                        )
                    )
                )
            )
        );
    }


    with link = "line.de.1205" {
        track(:second, tonpeo[:ton.f, :kat - 1sw]);
        with layer = 1 line_badge(:open, tonpeo[:kat - 2.0km], "1205");
    }


    with link = "point.de.Kating" {
        track(:second:station, tonpeo[:kat - 1sw, :kat + 1sw]);
        marker(:de.hp :right, tonpeo[:kat]);
        station(:top, tonpeo[:kat] >> 1.4sh,
            "Kating",
            hbox(:center:base,
                span(:open, "25,55 "),
                span(:removed, "(4,58)")
            )
        );
    }


    with link = "line.de.1205" {
        track(:second, tonpeo[:kat + 1sw, :kah - 1sw]);
    }


    with link = "point.de.Katharinenheerd" {
        track(:second:station, tonpeo[:kah - 1sw, :kah + 1sw]);
        marker(:de.hp :right, tonpeo[:kah]);
        with layer = -1 marker(:de.bf :removed :right, tonpeo[:kah]);
        station(:top, tonpeo[:kah] >> 1.4sh,
            "Katharinenheerd",
            hbox(:center:base,
                span(:open, "28,44 "),
                span(:removed, "(7,49)")
            )
        );
    }


    with link = "line.de.1205" {
        track(:second, tonpeo[:kah + 1sw, :gar.a]);
    }


    with link = "point.de.Garding" {
        # Gleis 1
        track(:second:station,
                tonpeo[:gar.a, :gar.f - 190m]
            --  tonpeo[:gar.f - 130m, :gar.f] << 1dt
        );

        # Gleis 2
        with layer = -1 track(:station :removed,
                tonpeo[:gar.a + 129m, :gar.a + 130m]
            --  tonpeo[:gar.a + 190m, :gar.f - 130m] << 1dt
        );

        # Gleis 7
        with layer = -1 track(:station :removed,
                tonpeo[:gar.a + 99m, :gar.a + 100m]
            --  tonpeo[:gar.a + 140m, :gar - 0.6sw] >> 1dt
        );

        marker(:de.hp :right, tonpeo[:gar]);
        with layer = -1 marker(:de.bf :removed :right, tonpeo[:gar]);
        station(:top, tonpeo[:gar] >> 1.4sh,
            "Garding",
            hbox(:center:base,
                span(:open, "31,53 "),
                span(:removed, "(10,59)")
            )
        );
    }


    with link = "line.de.1205" {
        track(:second,
                tonpeo[:gar.f, :gar.f + 1m] << 1dt
            ..  tonpeo[:gar.ff + 50m, :san - 1sw]
        );
    }


    with link = "point.de.Sandwehle" {
        track(:second:station, tonpeo[:san - 1sw, :san + 1sw]);
        marker(:de.hp :right, tonpeo[:san]);
        station(:top, tonpeo[:san] >> 1.4sh,
            "Sandwehle",
            hbox(:center:base,
                span(:open, "33,22 "),
                span(:removed, "(12,30)")
            )
        );
    }


    with link = "line.de.1205" {
        track(:second, tonpeo[:san + 1sw, :hei - 1sw]);
    }


    with link = "point.de.Heisternest" {
        track(:second:station, tonpeo[:hei - 1sw, :hei + 1sw]);
        with layer = -1 marker(:de.hp :removed :right, tonpeo[:hei]);
        station(:top :removed, tonpeo[:hei] >> 1.4sh,
            "Heisternest",
            hbox(:center:base,
                span(:open, "?? "),
                span(:removed, "(14,03)")
            )
        );
    }


    with link = "line.de.1205" {
        track(:second, tonpeo[:hei + 1sw, :tat - 1sw]);
    }


    with link = "point.de.Tating" {
        track(:second:station, tonpeo[:tat - 1sw, :tat + 1sw]);
        marker(:de.hp :right, tonpeo[:tat]);
        with layer = -1 marker(:de.bf :removed :right, tonpeo[:tat]);
        station(:top, tonpeo[:tat] >> 1.4sh,
            "Tating",
            hbox(:center:base,
                span(:open, "36,46 "),
                span(:removed, "(15,47)")
            )
        );
    }


    with link = "line.de.1205" {
        track(:second, tonpeo[:tat + 1sw, :pes - 1sw]);
        with layer = 1 line_badge(:open, tonpeo[:tat + 2.5km], "1205");
    }


    with link = "point.de.Bad-St-Peter-Süd" {
        track(:second:station, tonpeo[:pes - 1sw, :pes + 1sw]);
        marker(:de.hp :left, tonpeo[:pes]);
        with layer = -1 marker(:de.bf :removed :left, tonpeo[:pes]);
        station(:bottom, tonpeo[:pes] << 1.4sh,
            "Bad St Peter Süd",
            hbox(:center:base,
                span(:open, "41,00 "),
                span(:removed, "(19,98)")
            )
        );
    }


    with link = "line.de.1205" {
        track(:second, tonpeo[:pes + 1sw, :peo.a]);
    }


    with link = "point.de.Bad-St-Peter-Ording" {
        # Gleis 1
        track(:second:station, tonpeo[:peo.a, :f]);

        # Gleis 2
        with layer = -1 track(:station :removed,
                tonpeo[:peo.a + 139m, :peo.a + 140m]
            --  tonpeo[:peo.a + 200m, :f - 140m] << 1dt
            --  tonpeo[:f - 80m, :f - 79m]
        );

        # Gleis 4
        with layer = -1 track(:station :removed,
                tonpeo[:peo.a + 99m, :peo.a + 100m]
            --  tonpeo[:peo.a + 140m, :f - 200m] >> 1dt
        );

        marker(:de.hp :right, tonpeo[:f - 0.6sw]);
        with layer = -1 marker(:de.bf :removed :right, tonpeo[:f - 0.6sw]);
        station(:top, tonpeo[:f - 0.6sw] >> 1.6sh,
            span(:bold, "Bad St Peter-Ording"),
            hbox(:center:base,
                span(:open, "1205: 43,64 "),
                span(:removed, "(22,67)")
            )
        );
    }
}

