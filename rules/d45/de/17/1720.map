#
#
let lehcux = path("path.de.1720");

with detail = [4, 5] {
    # ...

    with link = "line.de.1720" {
        track(:first :double :cat, lehcux[:deu + 1sw, :lun.a]);
        with layer = 1 line_badge(:open, lehcux[:deu + 2.0km], "1720");
    }


    with link = "point.de.Lüneburg-Gbf" {
        track(:first:station :double :cat, lehcux[:lun.a, :lun.r]);
        marker(:de.bft :left, lehcux[:lug] << 0.5dt);
        station(:right, lehcux[:lug - 0.4sw] >> 1.5dt,
            "Lüneburg Gbf", "??"
        );
    }

    with link = "point.de.Lüneburg" {
        # Str. 1150
        track(:first:station,
                lehcux[:lun - 341m, :lun - 340m] >> 0.5dt
            --  lehcux[:lun - 280m, :lbn] >> 1.5dt
            ..  path("path.de.1150")[:aa - 1m, :aa]
        );

        # Str. 1720
        track(:first:station :double :cat, lehcux[:lun.r, :lun.u]);

        marker(:de.bf :left, lehcux[:lun] << 0.5dt);
        station(:right, lehcux[:lun - 0.4sw] >> 2.5dt,
            span(:bold, "Lüneburg"),
            hbox(:center:top,
                vbox(:right:top,
                    span(:open, "1150: "),
                    span(:open, "1720: ")
                ),
                vbox(:right:top,
                    span(:open, "131,57"),
                    span(:open, "131,57")
                )
            )
        );
    }

    with link = "point.de.Lüneburg-Westseite" {
        track(:second:station,
                lehcux[:fdan, :fdan + 100m] << 4.5dt
            ..  lehcux[:lun - 100m, :abuc] << 4dt
            ..  lehcux[:fluw - 50m, :fluw] << 1.5dt
        );

        marker(:de.bftp :left, lehcux[:lun] << 4dt);
        station(:left, lehcux[:lun - 0.3sw] << 4dt << 1.4sh,
            span(:bold, "Lüneburg Westseite"),
            "1151: 228,973"
        );
    }

    with link = "point.de.Lüneburg-Nordkopf" {
        # Str. 1720
        track(:first:station :double :cat, lehcux[:lun.u, :lun.f]);

        # Str. 1153
        track(:first:station :cat, lehcux[:fluw, :lun.f] << 1.5dt);

        # Str. 1151
        with layer = -1 track(:second:station :removed,
                lehcux[:ajes - 1m, :ajes] << 1.5dt
            ..  path("path.de.1151")[:ste - 1.1sw, :ste - 1sw]
        );

        marker(:de.bft :right, lehcux[:lkn] >> 0.5dt);
        station(:left, lehcux[:lkn - 0.3sw] << 3.5dt,
            "Lüneburg Nordkopf",
            hbox(:center:top,
                vbox(:right:top,
                    span(:open, "1151: "),
                    span(:open, "1153: "),
                    span(:open, "1720: ")
                ),
                vbox(:right:top,
                    span(:open, "??"),
                    span(:open, "??"),
                    span(:open, "??")
                )
            )
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat, lehcux[:lun.f, :bar - 1sw]);
        with layer = 1 line_badge(:open, lehcux[:bar - 1.8km] >> 0.5dt, "1720");
    }
    with link = "line.de.1153" {
        track(:first :cat, lehcux[:lun.f, :bah - 1sw] << 1.5dt);
        with layer = 1 line_badge(:open, lehcux[:bar - 1.8km] << 2.0dt, "1153");
    }


    with link = "point.de.Goseburg" {
    	with layer = -1 marker(:de.bk :removed :right, lehcux[:gos] >> 0.5dt);
        station(:right :removed, lehcux[:gos - 0.4sw] >> 1.2sw,
            "Goseburg", "134,16"
        );
    }


    with link = "point.de.Bardowick" {
        track(:first:station :double :cat, lehcux[:bar - 1sw, :bar + 1sw]);
        marker(:de.bf :right, lehcux[:bar] >> 0.5dt);
        station(:top, lehcux[:bar - 0.1sw] >> 0.5dt >> 1.6sh,
            "Bardowick", "137,41"
        );
    }

    with link = "point.de.Bardowick-Hp" {
        track(:first:station :cat, lehcux[:bah - 1sw, :bah + 1sw] << 1.5dt);
        marker(:de.hp :left, lehcux[:bah] << 1.5dt);
        station(:left, lehcux[:bah - 1.5sw] << 1.5dt << 1.7sh,
            "Bardowick Hp", "137,49"
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat, lehcux[:bar + 1sw, :rad - 1sw]);
    }
    with link = "line.de.1153" {
        track(:first :cat, lehcux[:bah + 1sw, :rad - 1sw] << 1.5dt);
    }


    with link = "point.de.Radbruch" {
        track(:first:station :double :cat, lehcux[:rad - 1sw, :rad + 1sw]);
        track(:first:station :cat, lehcux[:rad - 1sw, :rad + 1sw] << 1.5dt);

        marker(:de.bf :left, lehcux[:rad] << 1.5dt);
        station(:bottom, lehcux[:rad] << 1.5dt << 1.4sh,
            "Radbruch",
            hbox(:center:base,
                span(:removed, "143,62 → "),
                span(:open, "143,59")
            )
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat, lehcux[:rad + 1sw, :win.a]);
    }
    with link = "line.de.1153" {
        track(:first :cat, lehcux[:rad + 1sw, :win.a] << 1.5dt);
    }


    with link = "point.de.Borstel" {
    	with layer = -1 marker(:de.bk :removed :right, lehcux[:bor] >> 0.5dt);
        station(:top :removed, lehcux[:bor] >> 0.5dt >> 1.2sw,
            "Borstel", "147,49"
        );
    }


    with link = "point.de.Winsen-Luhe" {
        track(:first:station :double :cat, lehcux[:win.a, :win.f]);
        track(:first:station :cat, lehcux[:win.a, :win.f] << 1.5dt);
        
        marker(:de.bf :right, lehcux[:win] >> 0.5dt);
        with layer = -1 marker(:statcase :right, lehcux[:win] >> 0.5dt);
        station(:left, lehcux[:win - 0.3sw] << 1.5dt << 8pt,
            hbox(:center:base,
                span(:bold, "Winsen "),
                span(:regular, "(Luhe)")
            ),
            hbox(:center:top,
                vbox(:right:top,
                    span(:open, "1153: "),
                    span(:open, "1720: ")
                ),
                vbox(:right:top,
                    span(:open, "150,"),
                    span(:open, "150,")
                ),
                vbox(:left:top,
                    span(:open, "56"),
                    span(:open, "55")
                )
            )
        );
    }


    # ...
}

