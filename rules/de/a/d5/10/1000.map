# DE 1000.  Flensburg Weiche (ausschl) - Harrislee Grenze
#
let fh = path("d3.de.1000");

with detail = 5 {
    with railway = :first :cat:ac15 :pax {
        with link = "line.de.1000" {
            track(:double,
                    fh[:flw + 250m, :flw + 260m] << 10mo
                ..  fh[:fri.yf, :fri - 495m]
            );
        }

        with link = "point.de.Flensburg-Friedensweg", railway = :station {
            # Gl. 1000-2 - W303
            track(fh[:fri - 495m, :fri] << 0.5mo);

            # Gl. 95 - W 301
            track(
                    fh[:fri - 495m, :fri - 280m] >> 0.5mo
                ..  fh[:fri - 200m, :fri - 199m] >> 1.5mo
            );
            # Gl. 97 - Gl. 94
            track(
                    fh[:fri - 495m, :fri - 160m] >> 1.5mo
                ..  fh[:fri, :fri + 1wl] << 0.5mo
            );
            # W302 - Gl. 93
            track(
                    fh[:fri - 161m, :fri - 160m] >> 1.5mo
                ..  fh[:fri, :fri + 1wl] >> 0.5mo
            );

            marker(:de.abzw :open :right, fh[:fri] >> 0.5mo >> 0.5mt);
            station(
                :left, fh[:fri + 0.4sw] << 0.5mo << 6bp,
                hbox(:right:top,
                    span(:regular, "Flensburg "),
                    span(:bold, "Friedensweg")
                ),
                hbox(:right :top,
                    vbox(:left :top,
                        span(:xsmall, "1000: "),
                        span(:xsmall, "1005: ")
                    ),
                    vbox(:right :top,
                        span(:xsmall, "174,"),
                        span(:xsmall, "5,")
                    ),
                    vbox(:left :top,
                        span(:xsmall, "57 "),
                        span(:xsmall, "49")
                    ),
                    vbox(:left :top,
                        span(:xsmall :former, "(168,75)")
                    )
                )
            );

            with layer = -1 marker(:de.stw :removed :right,
                    fh[:fri - 180m] << 0.5mo
            );
            slabel(:right :removed, fh[:fri - 180m - 1mo] >> 2.5mo,
                "Np"
            );
        }

        with link = "line.de.1000" {
            track(:double, fh[:fri + 1wl, :fri + 1.7km]);
            line_badge(fh[:fri + 1.7km], "1000");
            track(:double, fh[:fri + 1.7km, :har - 130m]);
        }

        with link = "point.de.Harrislee", railway = :station {
            # Gl. 1
            track(
                    fh[:har - 130m, :har + 300m + 3wl] >> 0.5mo
            );
            # Gl. 2
            track(
                    fh[:har - 130m, :har + 300m + 3wl] << 0.5mo
            );
            # Gl. 3
            track(:side :removed,
                    fh[:har - 130m + 0.9wl, :har - 130m + 1wl] << 0.5mo
                ..  fh[:har - 130m + 2wl, :har + 300m - 2wl] << 1.5mo
                ..  fh[:har + 300m - 1wl, :har + 300m - 0.9wl] << 0.5mo
            );
            # W3 - W4
            track(:side :removed,
                    fh[:har + 300m - 0.1wl, :har + 300m] << 0.5mo
                --  fh[:har + 300m + 1wl, :har + 300m + 1.1wl] >> 0.5mo
            );

            # Agl. 1
            track(:side :removed,
                    fh[:har + 300m + 4wl, :har + 300m + 8wl] >> 2.5mo
                ..  fh[:har + 300m + 9wl, :har + 300m + 9.1wl] >> 3.5mo
            );
            # Agl. 2
            track(:side :removed,
                    fh[:har + 300m + 1.9wl, :har + 300m + 2wl] >> 0.5mo
                --  fh[:har + 300m + 5wl, :har + 980m] >> 3.5mo
            );
            # Agl. 3
            track(:side :removed,
                    fh[:har + 300m + 4.75wl, :har + 980m] >> 4.5mo
            );
            # Agl. 4
            track(:side :removed,
                    fh[:har + 300m + 3.74wl, :har + 300m + 3.75wl] >> 3.5mo
                --  fh[:har + 300m + 5.5wl, :har + 980m] >> 5.5mo
            );
            # Agl. 5
            track(:side :removed,
                    fh[:har + 300m + 2.9wl, :har + 300m + 3wl] >> 1.5mo
                --  fh[:har + 300m + 5wl, :har + 980m] >> 6.5mo
            );

            slabel(:right :removed, fh[:har + 300m + 12wl] >> 8mo,
                span(:italic, "Wehrbereichsverwaltung I Kiel")
            );

            with layer = -1 marker(:de.bf :removed :right, fh[:har] >> 0.5mo);
            station(
                :right :left_align :removed, fh[:har - .4sw] >> 1.5sw,
                "Harrislee", "177,44 (171,87)"
            );
        }

        with link = "line.de.1000" {
            track(:double, fh[:har + 300m + 3wl, :har + 1.6km]);
            line_badge(fh[:har + 1.6km], "1000");
            track(:double, fh[:har + 1.6km, :hag - 0.5sw]);
        }

        with link = "point.int.Harrislee-Padborg" {
            track(:first:station :double :cat:ac15 :pax,
                    fh[:hag - 0.5sw, :hag + 0.5sw]
            );
            marker(:de.dirgr, fh[:hag] >> 0.5mo);
            marker(:statdt, fh[:hag] << 0.5mo);
            marker(:de.dirgr :left, fh[:hag] << 0.5mo);
            label(
                fh[:hag] >> 5mo,
                vbox(:left :middle,
                    span(:medium, "Padborg gr√¶nse"),
                    hbar(0.3),
                    span(:medium, "Flensburg Grenze")
                )
            );
            label(
                fh[:hag] << 5mo,
                hbox(:right :middle,
                    vbox(:right :middle,
                        span(:xsmall, "DK 26: "),
                        hbar(0.3),
                        span(:xsmall, "DE 1000: ")
                    ),
                    vbox(:right :middle,
                        span(:xsmall, "110,"),
                        hbar(0.3),
                        span(:xsmall, "179,")
                    ),
                    vbox(:left :middle,
                        span(:xsmall, "6"),
                        hbar(0.3),
                        span(:xsmall, "784 ")
                    ),
                    vbox(:left :middle,
                        span(:xsmall, ""),
                        hbar(0.3),
                        span(:xsmall :removed, "(174,21)")
                    )
                )
            );
        }
    }
}

