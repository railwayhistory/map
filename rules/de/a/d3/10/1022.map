# DE 1022.  Kiel Hbf - Osterrönfeld
#
let ko = path("d3.de.1022");

with detail = 3 {
    # point.de.Kiel-Hbf  de.1220

    with link = "line.de.1022" {
        track(:first :pax,
                ko[:kie + 0.5sw, :kie.yh] >> 1.5dt
            ..  ko[:khg - 0.51sw, :khg - 0.5sw]
        );
    }

    with link = "point.de.Kiel-Hg" {
        track(:first :station :pax, ko[:khg - 0.5sw, :khg + 0.5sw]);
        marker(:right :de.bk :removed, ko[:khg]);
        slabel(:top :removed, ko[:khg] >> 1.2sh, "Hg");
    }

    with link = "line.de.1022" {
        track(:first :pax, ko[:khg + 0.5sw, :has - 1sw]);
    }

    with link = "point.de.Kiel-Hassee" {
        # DE 1020
        track(:second :station :pax, ko[:has, :has + 1sw]);

        # DE 1021
        track(:second :station :closed,
                ko[:has - 1.51dl, :has - 1.5dl]
            --  ko[:has - 0.5dl, :has + 1sw] >> 1dt
        );

        # DE 1022
        track(:first :station :pax, ko[:has - 1sw, :has]);
        track(:second :station :pax,
                ko[:has - 1.01dl, :has - 1dl]
            --  ko[:has, :has + 1sw] << 1dt
        );

        # DE 1032
        track(:first :station,
                ko[:has - 3.1dl, :has - 3dl] << 1dt
            --  ko[:has - 2dl, :has - 1.99dl]
        );

        marker(:left :de.bf :pax, ko[:has] << 1dt);
        slabel(:left :pax :bold, ko[:has] + (0dt, 300m) + (2sh, 0.5sw),
            hbox(:right:top, 
                vbox(:right:middle, "Kiel-Hassee", "Cittipark"),
                vbox(:right:middle, "", "*")
            )
        );
    }

    with link = "line.de.1022" {
        track(:second :pax,
                ko[:has + 1sw, :has.hn] << 1dt
            ..  ko[:has.fr, :rus - 1sw]
        );
    }

    with link = "point.de.Russee" {
        track(:second :station :pax, ko[:rus - 1sw, :rus + 1sw]);
        marker(:left :de.hp :pax, ko[:rus]);
        slabel(:left :pax, ko[:rus + 1sw] << 0.7dt,
            hbox(:right:top, "K.-Russee")
        );
    }

    with link = "line.de.1022" {
        track(:second :pax, ko[:rus + 1sw, :met - 1sw]);
    }

    with link = "point.de.Kiel-Mettenhof" {
        track(:second :station :pax, ko[:met - 1sw, :met + 1sw]);
        marker(:right :de.hp :removed, ko[:met]);
        slabel(:right :removed, ko[:met + 1sw] >> 1.4sw + (-1.2sw, 0dt),
            "K.-Mettenhof"
        );
    }

    with link = "line.de.1022" {
        track(:second :pax, ko[:met + 1sw, :mel - 1sw]);
    }

    with link = "point.de.Melsdorf" {
        track(:second :station :pax, ko[:mel - 1sw, :mel + 1sw]);
        marker(:right :de.hp :pax, ko[:mel]);
        marker(:right :de.exbf :pax, ko[:mel]);
        slabel(:left :pax, ko[:mel] << 0.8dt,
            hbox(:right:top, "Melsdorf")
        );
    }

    with link = "line.de.1022" {
        track(:second :pax, ko[:mel + 1sw, :fle - 1sw]);
        line_label(:right:s :pax, ko[:mel + 1.5km], " 1022");
    }

    with link = "point.de.Flemhude" {
        track(:second :station :pax, ko[:fle - 1sw, :fle + 1sw]);
        marker(:right :de.hp :removed, ko[:fle]);
        slabel(:top :removed, ko[:fle] >> 1.2sh, "Flemhude");
    }

    with link = "line.de.1022" {
        track(:second :pax, ko[:fle + 1sw, :ach - 1sw]);
    }

    with link = "point.de.Achterwehr" {
        track(:second :station :pax, ko[:ach - 1sw, :ach + 1sw]);
        marker(:left :de.hp :pax, ko[:ach]);
        slabel(:left :pax, ko[:ach + 0.3sw] >> 1.0dt, "Achterwehr");
    }

    with link = "line.de.1022" {
        track(:second :pax, ko[:ach + 1sw, :fel - 1sw]);
    }

    with link = "point.de.Felde-Brandsbek" {
        track(:second :station :pax, ko[:fel - 1sw, :fel + 1sw]);
        marker(:left :de.bf :pax, ko[:fel]);
        slabel(:bottom :pax, ko[:fel] << 1.2sh, "Felde-Brandsbek*");
    }

    with link = "line.de.1022" {
        track(:second :pax, ko[:fel + 1sw, :bre - 1sw]);
        line_label(:right:s :pax, ko[:bre - 2.0km], "1022");
    }

    with link = "point.de.Bredenbek" {
        track(:second :station :pax, ko[:bre - 1sw, :bre + 1sw]);
        marker(:left :de.hp :pax, ko[:bre]);
        slabel(:bottom :pax, ko[:bre] << 1.2sh, "Bredenbek");
    }

    with link = "line.de.1022" {
        track(:second :pax, ko[:bre + 1sw, :kro - 1sw]);
    }

    with link = "point.de.Kronsburg" {
        track(:second :station :pax, ko[:kro - 1sw, :kro + 1sw]);
        marker(:right :de.bf :removed, ko[:kro]);
        slabel(:top :removed, ko[:kro] >> 1.2sh, "Kronsburg");
    }

    with link = "line.de.1022" {
        track(:second :pax, ko[:kro + 1sw, :ost - 1sw]);
    }

    with link = "point.de.Ostenfeld-Rendsburg" {
        track(:second :station :pax, ko[:ost - 1sw, :ost + 1sw]);
        marker(:right :de.hst :removed, ko[:ost]);
        slabel(:right :removed, ko[:ost + 0.3sw] << 0.5dt,
            vbox(:left:top, "Ostenfeld", span(:light, "(Kr Rendsburg)"))
        );
    }

    with link = "line.de.1022" {
        track(:second :pax, ko[:ost + 1sw, :sul - 1sw]);
    }

    with link = "point.de.Schülldorf" {
        track(:second :station :pax, ko[:sul - 1sw, :sul + 1sw]);
        marker(:right :de.hp :pax, ko[:sul]);
        marker(:right :de.exbf :pax, ko[:sul]);
        slabel(:right :pax, ko[:sul] << 0.5dt,
            vbox(:left:top, "Schülldorf")
        );
    }

    with link = "line.de.1022" {
        track(:second :pax,
                ko[:sul + 1sw, :oro.r]
            ..  ko[:oro.yk, :oro.yk + 0.1dl] >> 1.5dt
        );
        line_label(:left:w :pax, ko[:oro.r - 0.7km], "1022");
    }

    with link = "point.de.Osterrönfeld-Awanst" {
        track(:second :station :pax, ko[:oro.yk, :oro - 0.5sw] >> 1.5dt);
        marker(:right :de.awanst, ko[:ora] >> 1.5dt);
    }

    # point.de.Osterrönfeld  de.1040
}

