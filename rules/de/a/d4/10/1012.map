# DE 1012.  BÃ¼delsdorf - Husum
#
let bh = path("d3.de.1012");

with detail = 4 {
    with railway = :side :nopax {
        with link = "line.de.1012" {
            track(bh[:bud.xh, :bud.xh + 0.7km]);
            line_label(:left:n, bh[:bud.xh + 0.7km], (0.5dt, 0dt), "1012");
            track(bh[:bud.xh + 0.7km, :gen]);
        }

        with link = "point.de.Rendsburg-Gewerbegebiet-Nord",
             railway = :station
        {
            marker(:right :de.anst, bh[:gen] >> 0.5lt);
            station(:top :right_align, bh[:gen] >> 1.3sh + (1.2sw, 0dt),
                "R. Gewerbegebiet Nord", "3,07  "
            );
        }
    }

    with railway = :second :pax :removed {
        with link = "line.de.1012" {
            track(bh[:gen, :foc - 0.5sw]);
        }

        with link = "point.de.Fockbek", railway = :station {
            track(bh[:foc - 0.5sw, :foc + 0.5sw]);
            marker(:left :de.bf, bh[:foc] << 0.5mt);
            station(:bottom, bh[:foc] << 0.5mt << 1.3sh, "Fockbek", "4,26");
        }

        with link = "line.de.1012" {
            track(bh[:foc + 0.5sw, :foc + 1.7km]);
            line_badge(bh[:foc + 1.7km], "1012");
            track(bh[:foc + 1.7km, :gar - 0.5sw]);
        }

        with link = "point.de.Garlbek", railway = :station {
            track(bh[:gar - 0.5sw, :gar + 0.5sw]);
            marker(:right :de.hp, bh[:gar] >> 0.5mt);
            slabel(:top, bh[:gar] >> 0.5mt >> 1.1sh, "Garlbek");
        }

        with link = "line.de.1012" {
            track(bh[:gar + 0.5sw, :hoh - 0.5sw]);
        }

        with link = "point.de.Hohn", railway = :station {
            track(bh[:hoh - 0.5sw, :hoh + 0.5sw]);
            marker(:left :de.bf, bh[:hoh] << 0.5mt);
            station(:bottom, bh[:hoh] << 0.5mt << 1.2sh, "Hohn", "10,75");
        }

        with link = "line.de.1012" {
            track(bh[:hoh + 0.5sw, :chr - 0.5sw]);
        }

        with link = "point.de.Christiansholm", railway = :station {
            track(bh[:chr - 0.5sw, :chr + 0.5sw]);
            marker(:left :de.bf, bh[:chr] << 0.5mt);
            station(:bottom, bh[:chr] << 0.5mt << 1.2sh + (-0.2sw, 0dt),
                "Christiansholm", "17,42"
            );
        }

        with link = "line.de.1012" {
            track(bh[:chr + 0.5sw, :erf - 0.5sw]);
        }

        with link = "point.de.Erfde", railway = :station {
            track(bh[:erf - 0.5sw, :erf + 0.5sw]);
            marker(:left :de.bf, bh[:erf] << 0.5mt);
            station(:bottom, bh[:erf] << 0.5mt << 1.2sh, "Erfde", "23,02");
        }

        with link = "line.de.1012" {
            track(bh[:erf + 0.5sw, :erf + 4km]);
            line_badge(bh[:erf + 4km], "1012");
            track(bh[:erf + 4km, :nor.x - 2mt]);
            with layer = -1 track(bh[:nor.x - 2mt, :nor - 0.5sw]);
        }

        with link = "point.de.Norderstapel", railway = :station {
            # DE 1012
            track(bh[:nor - 0.5sw, :nor + 200m]);

            # DE NSK
            track(
                    bh[:nor - 0.5sw, :nor + 100m] >> 1mt >> 1insh
                --  bh[:nor + 150m, :nor + 151m]
            );

            marker(:right :de.inbf, bh[:nor] >> 0.5mt);
            station(:left, bh[:nor - 0.3sw] << 4.5mt,
                span(:bold, "Norderstapel"),
                "1012: 31,04"
            );
        }

        with link = "line.de.1012" {
            track(bh[:nor.x + 2.5mt + 1sw, :nor + 2.5km]);
            line_badge(bh[:nor + 2.5km], "1012");
            track(bh[:nor + 2.5km, :swa - 0.5sw]);
        }

        with link = "point.de.Schwabstedt", railway = :station {
            track(bh[:swa - 0.5sw, :swa + 0.5sw]);
            marker(:left :de.hst, bh[:swa] << 0.5mt);
            marker(:left :de.exbf, bh[:swa] << 0.5mt);
            station(:right, bh[:swa - 0.5sw] >> 1.5mt, "Schwabstedt", "36,44");
        }

        with link = "line.de.1012" {
            track(bh[:swa + 0.5sw, :ran - 0.5sw]);
        }

        with link = "point.de.Rantrum", railway = :station {
            track(bh[:ran - 0.5sw, :ran + 0.5sw]);
            marker(:left :de.bf, bh[:ran] << 0.5mt);
            station(:right, bh[:ran - 0.6sw] >> 1.5mt, "Rantrum", "42,29");
        }

        with link = "line.de.1012" {
            track(bh[:ran + 0.5sw, :ran + 2.7km]);
            line_badge(bh[:ran + 2.7km], "1012");
            track(bh[:ran + 2.7km, :mil - 0.5sw]);
        }

        with link = "point.de.Mildstedt", railway = :station {
            track(bh[:mil - 0.5sw, :mil + 0.5sw]);
            marker(:left :de.hst, bh[:mil] << 0.5mt);
            marker(:left :de.exbf, bh[:mil] << 0.5mt);
            station(:left, bh[:mil - 0.5sw] << 2.3sh,
                "Mildstedt", "45,95"
            );
        }

        with link = "line.de.1012" {
            track(bh[:mil + 0.5sw, :hus.xb]);
        }
    }
}

