# DE 1720.  Lehrte - Cuxhaven
#
let lc = path("d4.de.a.1720");

with detail = [4, 5] {
    with link = "point.de.Bad-Bevensen-DGr-I" {
        track(:first:station :double :cat:ac15 :pax,
                lc[:gbevi - 0.5sw, :gbevi + 0.5sw]
        );
        with layer = -1 {
            marker(:de.dirgr :removed :right, lc[:gbevi] >> 0.5dt);
            marker(:de.dirgr :removed :left, lc[:gbevi] << 0.5dt);
        }
        label(lc[:gbevi - 0.3sw] << 5.0dt,
            hbox(:right:base :removed,
                span(:small, "Han/Hmb "),
                span(:xsmall, "104,30 ← 104,45")
            )
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax, lc[:gbevi + 0.5sw, :bev.a]);
    }


    with link = "point.de.Bad-Bevensen" {
        # Gl. 1 (Str. 1720 R)
        track(:first:station :cat:ac15 :pax, lc[:bev.a, :bev.f] >> 0.5dt);
    
        # Gl. 2 (Str. 1720 L)
        track(:first:station :cat:ac15 :pax, lc[:bev.a, :bev.f] << 0.5dt);

        # Gl. 5
        with layer = -1 track(:station :cat:ac15,
                lc[:bev.a + 100m - 1dl, :bev - 180m - 1dl] >> 1.5dt
        );

        # Gl. 6
        with layer = -1 track(:station :cat:ac15,
                lc[:bev.a + 100m - 1dl, :bev - 80m] << 1.5dt
        );

        # Gl. 7?
        with layer = -2 track(:station,
                lc[:bev - 400m, :bev - 180m - 2dl] << 2.5dt
            --  lc[:bev - 180m - 1dl, :bev - 180m - 0.9dl] << 1.5dt
        );

        # W1 - W4
        with layer = -1 track(:station :cat:ac15,
                lc[:bev.a + 100m] >> 0.5dt
            --  lc[:bev.a + 100m + 1dl] >> 1.5dt
        );

        # W2 - W3
        with layer = -1 track(:station :cat:ac15,
                lc[:bev.a + 100m] << 0.5dt
            --  lc[:bev.a + 100m + 1dl] << 1.5dt
        );

        # W8 - W9
        with layer = -1 track(:station :cat:ac15,
                lc[:bev - 180m - 3dl] >> 1.5dt
            --  lc[:bev - 180m - 2dl] >> 0.5dt
        );

        # W10 - W11
        with layer = -1 track(:station :cat:ac15,
                lc[:bev - 180m - 3dl] << 1.5dt
            --  lc[:bev - 180m - 2dl] << 0.5dt
        );

        # W14 - W15
        with layer = -1 track(:station :cat:ac15,
                lc[:bev - 180m - 1dl] >> 0.5dt
            --  lc[:bev - 180m] << 0.5dt
        );

        marker(:de.bf :cat:ac15 :pax :right, lc[:bev] >> 0.5dt);
        station(:right :cat:ac15 :pax, lc[:bev - 0.5sw] >> 0.5dt >> 1.4sw,
            "Bad Bevensen", "109,21"
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax, lc[:bev.a, :bie.a]);
    }


    with link = "point.de.Bruchtorf" {
        with layer = -1 marker(:de.bk :removed, lc[:bru] >> 0.5dt);
        station(:right :removed, lc[:bru - 0.5sw] >> 0.5dt >> 1.2sw,
            "Bruchtorf", "113,35"
        );
    }


    with link = "point.de.Bienenbüttel" {
        # Gl. 1 (Str. 1720 R)
        track(:first:station :cat:ac15 :pax, lc[:bie.a, :bie.f] >> 0.5dt);

        # Gl. 2 (Str. 1720 L)
        track(:first:station :cat:ac15 :pax, lc[:bie.a, :bie.f] << 0.5dt);

        # Gl. 3
        with layer = -1 track(:station :cat:ac15,
                lc[:bie.a + 100m + 1dl, :bie.a + 100m + 3dl] << 1.5dt
        );
        track(:station :cat:ac15 :pax,
                lc[:bie.a + 100m + 1.9dl, :bie.a + 100m + 2dl] << 0.5dt
            --  lc[:bie.a + 100m + 3dl, :bie.f - 100m - 3dl] << 1.5dt
            --  lc[:bie.f - 100m - 2dl, :bie.f - 100m - 1.9dl] << 0.5dt
        );
        with layer = -1 track(:station :cat:ac15,
                lc[:bie.f - 100m - 3dl, :bie.f - 100m - 1dl] << 1.5dt
        );

        # W1 - W2
        track(:station :cat:ac15,
                lc[:bie.a + 100m] >> 0.5dt
            --  lc[:bie.a + 100m + 1dl] << 0.5dt
        );

        # W15 - W16
        track(:station :cat:ac15,
                lc[:bie.f - 100m - 1dl] << 0.5dt
            --  lc[:bie.f - 100m] >> 0.5dt
        );

        marker(:de.bf :cat:ac15 :pax :right, lc[:bie] >> 0.5dt);
        station(:right :cat:ac15 :pax, lc[:bie - 0.5sw] >> 0.5dt >> 1.3sw,
            "Bienenbüttel",
            hbox(:center:base,
                "118,61 ", span(:removed, "← 118,63")
            )
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax, lc[:bie.f, :deu.a]);
    }


    with link = "point.de.Hohenbostel" {
        with layer = -1 marker(:de.bk :removed :right, lc[:hbo] >> 0.5dt);
        station(:right :removed, lc[:hbo - 0.5sw] >> 0.5dt >> 1.3sw,
            "Hohenbostel", "122,20"
        );
    }


    with link = "point.de.Deutsch-Evern" {
        # Gl. 1 (Str. 1720 L)
        track(:first:station :cat:ac15 :pax, lc[:deu.a, :deu.f] << 0.5dt);

        # Gl. 2 (Str. 1720 R)
        track(:first:station :cat:ac15 :pax, lc[:deu.a, :deu.f] >> 0.5dt);

        # Gl. 3
        with layer = -1 track(:station :cat:ac15,
                lc[:deu.a + 100m + 1dl, :deu.f - 100m - 1dl] >> 1.5dt
        );

        # W1 - W2
        with layer = -1 track(:station :cat:ac15,
                lc[:deu.a + 100m] << 0.5dt
            --  lc[:deu.a + 100m + 1dl] >> 0.5dt
        );

        # W4 - W5
        with layer = -1 track(:station :cat:ac15,
                lc[:deu.a + 100m + 2dl] >> 0.5dt
            --  lc[:deu.a + 100m + 3dl] >> 1.5dt
        );

        # W6 - W7
        with layer = -1 track(:station :cat:ac15,
                lc[:deu.f - 100m - 3dl] >> 1.5dt
            --  lc[:deu.f - 100m - 2dl] >> 0.5dt
        );

        # W8 - W9
        with layer = -1 track(:station :cat:ac15,
                lc[:deu.f - 100m - 1dl] >> 0.5dt
            --  lc[:deu.f - 100m] << 0.5dt
        );

        marker(:de.bbf :cat:ac15 :left, lc[:deu] << 0.5dt);
        with layer = -1 marker(:de.bf :removed :left, lc[:deu] << 0.5dt);
        station(:right :cat:ac15, lc[:deu - 0.4sw] >> 3.0dt,
            "Deutsch Evern", "125,91"
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax, lc[:deu.f, :lun.a]);
        with layer = 1 line_badge(:cat:ac15 :pax, lc[:deu + 2.0km], "1720");
    }


    with link = "point.de.Lüneburg-Gbf" {
        # Gl. 1 (Str. 1720 L)
        track(:first:station :cat:ac15 :pax, lc[:lun.a, :lun.r] << 0.5dt);

        # Gl. 2 (Str. 1720 R)
        track(:first:station :cat:ac15 :pax, lc[:lun.a, :lun.r] >> 0.5dt);

        # Gl. 20
        with layer = 1 track(:station :cat:ac15,
                lc[:lun.a + 100m + 2dl, :lun.r] >> 1.5dt
        );

        # Gl. 31
        with layer = 1 track(:station :cat:ac15,
                lc[:lun.a + 100m + 3dl, :lun.r] << 1.5dt
        );

        # Gl. 33
        with layer = 1 track(:station :cat:ac15,
                lc[:lun.a + 100m + 7dl, :lun.r + 150m] << 2.5dt
        );

        # Gl. 38
        with layer = 1 track(:station :cat:ac15,
                lc[:lun.a + 100m + 8dl, :lun.r - 4dl] << 3.5dt
            --  lc[:lun.r - 1dl, :lun.r - 0.9dl] << 0.5dt
        );

        # Gl. 39
        with layer = 1 track(:station :cat:ac15,
                lc[:lun.a + 100m + 5.9dl, :lun.a + 100m + 6dl] << 1.5dt
            --  lc[:lun.a + 100m + 9dl, :lun.r - 3dl] << 4.5dt
            ..  lc[:lun - 250m - 1dl, :lun - 250m - 0.9dl] << 6.5dt
        );

        # W3 - W4
        with layer = 1 track(:station :cat:ac15,
                lc[:lun.a + 100m] << 0.5dt
            --  lc[:lun.a + 100m + 1dl] >> 0.5dt
        );

        # W7 - W12
        with layer = 1 track(:station :cat:ac15,
                lc[:lun.a + 100m + 2dl] >> 0.5dt
            --  lc[:lun.a + 100m + 3dl] << 0.5dt
        );

        # W10 - W15
        with layer = 1 track(:station :cat:ac15,
                lc[:lun.a + 100m + 3dl] >> 0.5dt
            --  lc[:lun.a + 100m + 4dl] >> 1.5dt
        );

        # W13 - W17
        with layer = 1 track(:station :cat:ac15,
                lc[:lun.a + 100m + 4dl] << 0.5dt
            --  lc[:lun.a + 100m + 5dl] << 1.5dt
        );

        # W67 - W68
        with layer = 1 track(:station :cat:ac15,
                lc[:lun.r - 6dl] >> 1.5dt
            --  lc[:lun.r - 5dl] >> 0.5dt
        );

        # W69 - W70
        with layer = 1 track(:station :cat:ac15,
                lc[:lun.r - 4dl] >> 0.5dt
            --  lc[:lun.r - 3dl] << 0.5dt
        );

        marker(:de.bft :cat:ac15 :right, lc[:lug] >> 1.5dt);
        station(:right :cat:ac15, lc[:lug - 0.35sw] >> 1.5dt >> 1.2sw,
            "Lüneburg Gbf", "1720: 130,50"
        );
    }


    with link = "point.de.Lüneburg" {
        # Gl. 1 (Str. 1720 L)
        track(:first:station :cat:ac15 :pax, lc[:lun.r, :lun.xn] << 0.5dt);

        # Gl. 2 (Str. 1720 R)
        track(:first:station :cat:ac15 :pax, lc[:lun.r, :lun.xn] >> 0.5dt);

        # Gl. 3 (Str. 1150)
        track(:station :cat:ac15 :pax,
                lc[:lun.r, :lun.r + 4dl] >> 1.5dt
        );
        track(:first:station :cat:ac15 :pax,
                lc[:lun.r + 2.9dl, :lun.r + 3dl] >> 0.5dt
            --  lc[:lun.r + 4dl, :lun.yb + 2dl] >> 1.5dt
        );
        with layer = -1 track(:first:station :pax,
                lc[:lun.yb + 2dl, :lun.yb + 2.1dl] >> 1.5dt
            ..  path("d4.de.1150")[:lun.kk - 0.1dl, :lun.kk]
        );

        # Gl. 4 (Str. 9110)
        with layer = -1 track(:station :cat:ac15,
                lc[:lun.r + 5dl, :lun.yb] >> 2.5dt
        );

        # Gl. 5
        with layer = -1 track(:station :cat:ac15,
                lc[:lun.r + 3.9dl, :lun.r + 4dl] >> 1.5dt
            --  lc[:lun.r + 6dl, :lun.yb - 4dl] >> 3.5dt
            --  lc[:lun.yb - 3dl, :lun.yb - 2.9dl] >> 2.5dt
        );

        # W93 - W97
        with layer = -1 track(:station :cat:ac15,
                lc[:lun.r + 1dl] << 0.5dt
            --  lc[:lun.r + 2dl] >> 0.5dt
        );

        # W165 - W170
        with layer = -1 track(:station :cat:ac15,
                lc[:lun.yb - 1dl] >> 1.5dt
            --  lc[:lun.yb] >> 0.5dt
        );

        # W168 - W169
        with layer = -1 track(:station :cat:ac15,
                lc[:lun.yb] >> 2.5dt
            --  lc[:lun.yb + 1dl] >> 1.5dt
        );

        # W171 - W172
        with layer = -1 track(:station :cat:ac15,
                lc[:lun.yb + 1dl] >> 0.5dt
            --  lc[:lun.yb + 2dl] << 0.5dt
        );

        marker(:de.bf :cat:ac15 :pax :left, lc[:lun] << 0.5dt);
        with layer = -1 marker(:de.bf.casing :left, lc[:lun] << 0.5dt);
        station(:right :cat:ac15 :pax, lc[:lun - 0.4sw] >> 5dt,
            span(:bold, "Lüneburg"),
            hbox(:center:top,
                vbox(:right:top,
                    "1150: ", "1720: "
                ),
                vbox(:right:top,
                    "131,57", "131,57"
                )
            )
        );
    }

    with link = "point.de.Lüneburg-Nordkopf" {
        # Str. 1720
        track(:first:station :double :cat:ac15 :pax, lc[:lun.xn, :lun.f]);

        # Str. 1153
        track(:first:station :cat:ac15 :pax, lc[:lkn - 3dl, :lun.f] << 1.5dt);

        # Str. 1151
        with layer = -4 track(:second:station :removed,
                lc[:lun.yj - 0.1dl, :lun.yj] << 1.5dt
            ..  path("d4.de.a.1151")[:ste - 1.1sw, :ste - 1sw]
        );

        # W201 - W203
        with layer = -1 track(:station :cat:ac15,
                lc[:lkn - 3dl] << 1.5dt
            --  lc[:lkn - 2dl] << 0.5dt
        );

        # W206 - W207
        with layer = -1 track(:station :cat:ac15,
                lc[:lkn + 1dl] << 0.5dt
            --  lc[:lkn + 2dl] >> 0.5dt
        );

        # W208 - W209
        with layer = -1 track(:station :cat:ac15,
                lc[:lkn + 3dl] << 0.5dt
            --  lc[:lkn + 4dl] << 1.5dt
        );

        with layer = -1 marker(:de.bft :cat:ac15 :right, lc[:lkn] >> 0.5dt);
        station(:left :cat:ac15, lc[:lkn - 0.3sw] << 3.5dt,
            "Lüneburg Nordkopf",
            hbox(:center:top,
                vbox(:right:top,
                    "1151: ", "1153: ", "1720: "),
                vbox(:right:top,
                    "230,", "132,", "132,"
                ),
                vbox(:left:top,
                    "36", "94", "80"
                )
            )
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax, lc[:lun.f, :bar.a]);
        with layer = 1 line_badge(
            :cat:ac15 :pax, lc[:bar - 1.8km] >> 0.5dt, "1720"
        );
    }


    with link = "point.de.Goseburg" {
    	with layer = -1 marker(:de.bk :removed :right, lc[:gos] >> 0.5dt);
        station(:right :removed, lc[:gos - 0.4sw] >> 1.2sw,
            "Goseburg", "134,16"
        );
    }


    with link = "point.de.Bardowick" {
        # Gl. 1 (Str. 1720 R)
        track(:first:station :cat:ac15 :pax, lc[:bar.a, :bar.f] >> 0.5dt);

        # Gl. 2 (Str. 1720 L)
        track(:first:station :cat:ac15 :pax, lc[:bar.a, :bar.f] << 0.5dt);

        # Gl. 4
        with layer = -1 track(:station :cat:ac15,
                lc[:bar + 0.6sw, :bar.f - 100m + 1dl] >> 1.5dt
        );

        # W1 - W2
        with layer = -1 track(:station :cat:ac15,
                lc[:bar.a + 100m] >> 0.5dt
            --  lc[:bar.a + 100m + 1dl] << 0.5dt
        );

        # W5 - W6
        with layer = -1 track(:station :cat:ac15,
                lc[:bar + 0.6sw + 1dl] >> 0.5dt
            --  lc[:bar + 0.6sw + 2dl] >> 1.5dt
        );

        # W13 - W14
        with layer = -1 track(:station :cat:ac15,
                lc[:bar.f - 100m - 3dl] << 0.5dt
            --  lc[:bar.f - 100m - 2dl] >> 0.5dt
        );

        # W16 - W15
        with layer = -1 track(:station :cat:ac15,
                lc[:bar.f - 100m - 1dl] >> 1.5dt
            --  lc[:bar.f - 100m] >> 0.5dt
        );

        marker(:de.bf :cat:ac15 :pax :right, lc[:bar] >> 0.5dt);
        station(:top :cat:ac15 :pax, lc[:bar - 0.1sw] >> 0.5dt >> 1.6sh,
            "Bardowick", "1720: 137,41"
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax, lc[:rad - 1sw, :bar.f]);
    }


    with link = "point.de.Radbruch" {
        track(:first:station :double :cat:ac15 :pax,
                lc[:rad - 1sw, :rad + 1sw]
        );
        track(:first:station :cat:ac15 :pax,
                lc[:rad - 1sw, :rad + 1sw] << 1.5dt
        );

        marker(:de.hp :cat:ac15 :pax :left, lc[:rad] << 1.5dt);
        with layer = -1 marker(:de.bf :removed :left, lc[:rad] << 1.5dt);
        station(:bottom :cat:ac15 :pax, lc[:rad + 0.5sw] << 1.5dt << 1.8sh,
            "Radbruch",
            hbox(:center:base,
                span(:removed, "143,62 → "), "143,59"
            )
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax, lc[:rad + 1sw, :win.a]);
    }


    with link = "point.de.Borstel" {
    	with layer = -1 marker(:de.bk :removed :right, lc[:bor] >> 0.5dt);
        station(:top :removed, lc[:bor - 0.3sw] >> 0.5dt >> 1.6sw,
            "Borstel", "147,49"
        );
    }


    with link = "point.de.Winsen-Luhe" {
        # Gl. 1 (Str. 1720 R)
        track(:first:station :cat:ac15 :pax, lc[:win.a, :win.f] >> 0.5dt);

        # Gl. 2 (Str. 1720 L)
        track(:first:station :cat:ac15 :pax, lc[:win.a, :win.f] << 0.5dt);

        # Gl. 3
        with layer = -1 track(:station :cat:ac15,
                lc[:win - 480m - 3dl, :win - 480m] << 1.5dt
        );
        track(:station :cat:ac15 :pax,
                lc[:win - 480m, :win] << 1.5dt
        );
        with layer = -1 track(:station :cat:ac15,
                lc[:win, :win + 3dl] << 1.5dt
        );

        # Gl.4 (Str. 1153)
        track(:first:station :cat:ac15 :pax,
                lc[:win.a, :win - 480m - 5dl] << 1.5dt
            --  lc[:win - 480m - 4dl, :win + 4dl] << 2.5dt
            --  lc[:win + 5dl, :win.f] << 1.5dt
        );

        # Gl. 5
        with layer = -1 track(:station :cat:ac15,
                lc[:win.a + 100m + 1dl, :win - 0.6sw] >> 1.5dt
        );

        # Gl. 6
        with layer = -2 track(:station,
                lc[:win.a + 299m, :win.a + 300m] >> 1.5dt
            --  lc[:win.a + 300m + 1dl, :fnie - 1dl] >> 2.5dt
            --  lc[:fnie, :fnie + 0.1dl] >> 3.5dt
        );

        # W1 - W2
        with layer = -1 track(:station :cat:ac15,
                lc[:win.a + 100m] >> 0.5dt
            --  lc[:win.a + 100m + 1dl] << 0.5dt
        );

        # W3 - W4
        track(:station :cat:ac15,
                lc[:win.a + 100m + 2dl] >> 0.5dt
            --  lc[:win.a + 100m + 3dl] >> 1.5dt
        );

        # W14 - W17
        track(:station :cat:ac15 :pax,
                lc[:win - 480m - 1dl] << 0.5dt
            --  lc[:win - 480m] << 1.5dt
        );

        # W15 - W16
        with layer = -1 track(:station :cat:ac15,
                lc[:win - 480m - 2dl] << 2.5dt
            --  lc[:win - 480m - 1dl] << 1.5dt
        );

        # W27 - W30
        with layer = -1 track(:station :cat:ac15,
                lc[:win - 0.6sw - 2dl] >> 1.5dt
            --  lc[:win - 0.6sw - 1dl] >> 0.5dt
        );

        # W39 - W40
        track(:station :cat:ac15 :pax,
                lc[:win] << 1.5dt
            --  lc[:win + 1dl] << 0.5dt
        );

        # W41 - W42
        with layer = -1 track(:station :cat:ac15,
                lc[:win + 1dl] << 1.5dt
            --  lc[:win + 2dl] << 2.5dt
        );

        # W43 - W44
        with layer = -1 track(:station :cat:ac15,
                lc[:win + 2dl] << 0.5dt
            --  lc[:win + 3dl] >> 0.5dt
        );

        
        marker(:de.bf :cat:ac15 :pax :right, lc[:win] >> 0.5dt);
        with layer = -1 marker(:statcase :right, lc[:win] >> 0.5dt);
        station(:left:cat:ac15 :pax , lc[:win - 0.3sw] << 2.5dt << 8pt,
            hbox(:center:base,
                span(:bold, "Winsen "),
                span(:regular, "(Luhe)")
            ),
            hbox(:center:top,
                vbox(:right:top,
                    "1153: ",
                    "1720: "
                ),
                vbox(:right:top,
                    "150,",
                    "150,"
                ),
                vbox(:left:top,
                    "56",
                    "55"
                )
            )
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax, lc[:win.f, :asa - 1sw]);
    }


    with link = "point.de.Ashausen-Abzw" {
        # Str. 1281
        with layer = -1 track(:first:station :cat:ac15 :pax,
                lc[:asa - 1.1dl, :asa - 1dl] >> 0.5dt
            --  lc[:asa, :asa + 1dl] >> 1.5dt
        );

        # Str. 1720 L
        track(:first:station :cat:ac15 :pax,
                lc[:asa - 1sw, :asa + 1dl] << 0.5dt
        );

        # Str. 1720 R
        track(:first:station :cat:ac15 :pax,
                lc[:asa - 1sw, :asa + 1dl] >> 0.5dt
        );

        with layer = -1 marker(:de.abzw :cat:ac15 :right, lc[:asa] >> 1.5dt);
        station(:right :cat:ac15, lc[:asa + 0.3sw] >> 1.5dt >> 1.4sw,
            span(:bold, "Ashausen Abzw"),
            hbox(:center:top,
                vbox(:right:top, "1281: ", "1720: "),
                vbox(:right:top, "154,", "154,"),
                vbox(:left:top, "76", "76")
            )
        );
    }


    with link = "line.de.1720" {
       track(:first :double :cat:ac15 :pax, lc[:asa + 1dl, :ste.a]);
    }


    with link = "point.de.Stelle" {
        # Gl. 1 (Str. 1153 - Str. 1284 L)
        track(:first:station :cat:ac15 :pax,
                lc[:ste.a, :ste.f - 400m - 3dl] << 1.5dt
            --  lc[:ste.f - 400m - 2dl, :ste.f - 400m - 1.9dl] << 0.5dt
        );
        with layer = -1 track(:first:station :cat:ac15,
                lc[:ste.f - 400m - 3dl, :ste.f - 400m] << 1.5dt
        );

        # Gl. 2 (Str. 1720 L)
        track(:first:station :cat:ac15 :pax, lc[:ste.a, :ste.f] << 0.5dt);

        # Gl. 3 (Str. 1720 R)
        track(:first:station :cat:ac15 :pax, lc[:ste.a, :ste.f] >> 0.5dt);

        # Gl. 4
        track(:station :cat:ac15 :pax,
                lc[:ste.a + 100m + 6dl, :ste.f - 400m - 3dl] >> 1.5dt
            --  lc[:ste.f - 400m - 2dl, :ste.f - 400m - 1.9dl] >> 0.5dt
        );
        with layer = -1 track(:station :cat:ac15,
                lc[:ste.f - 400m - 3dl, :ste.f - 400m - 1dl] >> 1.5dt
        );

        # Gl. 5 (Str. 1281)
        track(:first:station :cat:ac15 :pax,
                lc[:ste.a, :ste.a + 100m + 6dl] >> 1.5dt
        );
        with layer = -1 track(:first:station :cat:ac15,
                lc[:ste.a + 100m - 5.9dl, :ste.a + 100m + 6dl] >> 1.5dt
            --  lc[:ste.a + 100m + 8dl, :ste.f - 400m] >> 3.5dt
        );

        # W1 - W3
        with layer = -1 track(:station :cat:ac15,
                lc[:ste.a + 100m + 2dl] << 0.5dt
            --  lc[:ste.a + 100m + 3dl] >> 0.5dt
        );

        # W2 - W5
        with layer = -1 track(:station :cat:ac15,
                lc[:ste.a + 100m + 3dl] << 0.5dt
            --  lc[:ste.a + 100m + 4dl] << 1.5dt
        );

        # W4 - W6
        with layer = -1 track(:station :cat:ac15,
                lc[:ste.a + 100m + 4dl] >> 0.5dt
            --  lc[:ste.a + 100m + 5dl] >> 1.5dt
        );

        # W8 - W9
        with layer = -1 track(:station :cat:ac15,
                lc[:ste.a + 100m] << 1.5dt
            --  lc[:ste.a + 100m + 1dl] << 0.5dt
        );

        # W10 - W11
        with layer = -1 track(:station :cat:ac15,
                lc[:ste.a + 100m + 7dl] >> 0.5dt
            --  lc[:ste.a + 100m + 8dl] >> 1.5dt
        );

        # W23 - W25
        with layer = -1 track(:station :cat:ac15,
                lc[:ste.f - 400m - 1dl] >> 0.5dt
            --  lc[:ste.f - 400m] << 0.5dt
        );

        marker(:de.bf :cat:ac15 :pax :left, lc[:ste] << 1.5dt);
        station(:bottom :cat:ac15 :pax, lc[:ste + 0.5sw] << 1.5dt << 1.8sw,
            span(:bold, "Stelle"),
            hbox(:center:top,
                vbox(:right:top,
                    "1281: ", "1720: ", "1153: ", "1284: "
                ),
                vbox(:right:top,
                    "158,", "158,", "158,", "18,"
                ),
                vbox(:left:top,
                    "17", "17", "17", "15"
                )
            )
        );
    }


    with link = "line.de.1720" {
       track(:first :double :cat:ac15 :pax, lc[:ste.f, :mas.a]);
    }


    with link = "point.de.Maschen-Pbf" {
        # Gl. 1 (Str. 1720 R)
        track(:first:station :cat:ac15 :pax,
                lc[:mas.a, :mas.a + 150m - 3dl] >> 0.5dt
            --  lc[:mas.a + 150m - 1dl, :mas - 450m] >> 1.5dt
            --  lc[:mas - 450m + 2dl, :mas + 320m - 2dl] >> 2.5dt
            --  lc[:mas + 320m + 2dl, :mas.f] >> 0.5dt
        );

        # Gl. 2
        track(:station :cat:ac15 :pax,
                lc[:mas - 450m, :mas + 320m] >> 1.5dt
        );
        with layer = -1 track(:station :cat:ac15,
                lc[:mas + 320m - 2.5dl] >> 1.5dt
            --  lc[:mas + 320m - 0.5dl] >> 0.5dt
        );

        # Gl. 3
        with layer = -1 track(:station :cat:ac15,
                lc[:mas.a + 150m, :mas - 450m] >> 0.5dt
        );
        track(:station :cat:ac15 :pax,
                lc[:mas - 450m - 1.1dl, :mas - 450m - 1dl] << 0.5dt
            --  lc[:mas - 450m, :mas + 320m - 4dl] >> 0.5dt
            --  lc[:mas + 320m - 3dl, :mas + 320m - 2.99dl] << 0.5dt
        );
            with layer = -1 track(:station :cat:ac15,
                    lc[:mas - 450m + 1dl] >> 0.5dt
                --  lc[:mas - 450m + 2dl] >> 1.5dt
            );
            with layer = -1 track(:station :cat:ac15,
                    lc[:mas + 320m - 4dl] >> 0.5dt
                --  lc[:mas + 320m - 3dl] >> 1.5dt
            );

        # Gl. 4 (Str. 1720 L)
        track(:first:station :cat:ac15 :pax, lc[:mas.a, :mas.f] << 0.5dt);

        marker(:de.bf :cat:ac15 :pax, lc[:mas] >> 2.5dt);
        station(:right:left_align :cat:ac15 :pax,
            lc[:mas - 0.8sw] >> 2.5dt >> 1.2sw,
            vbox(:left:bottom,
                span(:removed, "Maschen"),
                "Maschen Pbf"
            ),
            hbox(:left:base,
                "  1720: ", span(:removed, "162,37 → "), "161,64"
            )
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax,
                lc[:mas.f, :mas.f + 0.1dl]
            ..  lc[:mea.a - 0.1dl, :mea.a] >> 1dt
        );
    }


    with link = "point.de.Meckelfeld" {
        # Gl. 1043 (Str. 1720 L)
        track(:first:station :cat:ac15 :pax,
                lc[:mea.a, :meh - 1sw] >> 0.5dt);

        # Gl. 1054 (Str. 1720 R)
        track(:first:station :cat:ac15 :pax,
                lc[:mea.a, :meh - 1sw] >> 1.5dt
        );

        # W1215 - W1212
        with layer = -1 track(:station :cat:ac15,
                lc[:mea + 4dl] >> 0.5dt
            --  lc[:mea + 6dl] >> 1.5dt
        );

        # W1221 - W1217
        with layer = -1 track(:station :cat:ac15,
                lc[:mea] << 0.5dt
            --  lc[:mea + 2dl] >> 0.5dt
        );

        # W1238 - W1223
        with layer = -1 track(:station :cat:ac15,
                lc[:mea - 4dl] >> 0.5dt
            --  lc[:mea - 2dl] << 0.5dt
        );

        # W1240 - W1239
        with layer = -1 track(:station :cat:ac15,
                lc[:mea - 7dl] >> 1.5dt
            --  lc[:mea - 5dl] >> 0.5dt
        );

        with layer = -1 marker(:de.bft.abzw :cat:ac15, lc[:mea] >> 1.5dt);
        with layer = -4 marker(:de.bf :gone, lc[:mea] >> 1.5dt);
        label(:cat:ac15, lc[:mea - 0.5sw] >> 1.5dt >> 1.7sw,
            hbox(:left:middle,
                span(:medium:bold, "Meckelfeld  "),
                hbox(:center:bottom :xsmall,
                    vbox(:right:bottom, "1255: ", "1280: ", "1720: "),
                    vbox(:right:bottom, "0,", "24,", "164,"),
                    vbox(:left:bottom, "00", "60", "20")
                )
            )
        );
    }


    with link = "point.de.Meckelfeld-Hp" {
        track(:first:station :double :cat:ac15 :pax,
                lc[:meh - 1sw, :meh + 300m] >> 1dt
        );
        marker(:de.hp :cat:ac15 :pax :right, lc[:meh] >> 1.5dt);
        label(:cat:ac15 :pax, lc[:meh - 0.7sw] >> 1.5dt >> 1.2sw,
            hbox(:left:bottom, vbox(:center:bottom,
                span(:xsmall, "1720: 165,00"),
                span(:medium, "Meckelfeld Hp")
            ))
        );
    }
}

with detail = 4 {
    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax,
                lc[:har.ys - 350m, :meh + 300m
        ] << 1dt);

        # Str. 1720 R
        track(:first :cat:ac15 :pax :tight,
                lc[:har.ys - 350m, :har.ys - 340m] >> 1.5dt
            ..  lc[:har.ys + 100m, :hrb - 450m] >> 1.5dt
        );

        # Str. 1720 L
        track(:first :cat:ac15 :pax :tight :flip,
                lc[:har.ys - 350m, :har.ys - 340m] >> 0.5dt
            ..  lc[:har.ys + 100m, :hrb - 450m] << 1.5dt
        );
    }

    # point.de.Hamburg-Harburg-Hga  de.2200
    # point.de.Hamburg-Harburg      de.2200


    # point.de.Hamburg-Harburg: de.2200


    with link = "point.de.Hamburg-Unterelbe" {
        # Gl. 1 (Str. 1720 L)
        track(:first:station :cat:ac15 :pax,
                lc[:unt - 100m, :unt.f] << 0.5dt
        );

        # Gl. 2 (Str. 1720 R)
        track(:first:station :cat:ac15 :pax,
                lc[:unt - 100m, :unt.f] >> 0.5dt
        );

        # Gl. 15 (Str. 1252 L)
        with layer = -1 track(:station :cat:ac15,
                lc[:unt + 2.9dl, :unt + 3dl] >> 2.5dt
            --  lc[:unt + 4dl, :unt + 6dl] >> 1.5dt
        );

        # Gl. 16 (Str. 1252 R)
        with layer = -2 track(:station,
                lc[:unt - 1dl, :unt + 1dl] >> 1.5dt
        );
        with layer = -1 track(:first:station :cat:ac15,
                lc[:unt - 0.1dl, :unt] >> 0.5dt
            --  lc[:unt + 2dl, :unt + 6dl] >> 2.5dt
        );

        # W1 - W2
        with layer = -1 track(:station :cat:ac15,
                lc[:unt - 2dl] << 0.5dt
            --  lc[:unt - 1dl] >> 0.5dt
        );

        with layer = -1 marker(:de.bbf :cat:ac15 :left, lc[:unt] << 0.5dt);
        with layer = -2 marker(:de.bf :removed :left, lc[:unt] << 0.5dt);
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax, lc[:unt + 3dl, :tem - 1sw]);
    }


    with link = "point.de.Hamburg-Tempowerk" {
        track(:first:station :double :cat:ac15 :pax,
                lc[:tem - 1sw, :tem + 0.55sw]
        );
        with layer = -1 marker(:de.hp :removed :right, lc[:tem] >> 0.5dt);
    }


    with link = "point.de.Heimfeld" {
        track(:first:station :double :cat:ac15 :pax,
                lc[:tem + 0.55sw, :tem + 2.1sw]
        );
        with layer = -1 marker(
            :de.bk :removed :right, lc[:tem + 1.1sw] >> 0.5dt
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax, lc[:tem + 2.1sw, :haa.a]);
    }


    with link = "point.de.Hamburg-Hausbruch" {
        # Gl. 1 (Str. 1720 L)
        track(:first:station :cat:ac15 :pax, lc[:haa.a, :haa.f] << 0.5dt);

        # Gl. 2 (Str. 1720 R)
        track(:first:station :cat:ac15 :pax, lc[:haa.a, :haa.f] >> 0.5dt);

        # Gl. 3 (Str. 1293 L)
        with layer = -1 track(:first:station :cat:ac15,
                lc[:haa.a + 100m + 2.9dl, :haa.a + 100m + 3dl] >> 0.5dt
            --  lc[:haa.a + 100m + 4dl, :hbm.yh] >> 1.5dt
        );

        # Gl. 4 (Str. 1293 R)
        with layer = -1 track(:first:station :cat:ac15,
                lc[:haa.a + 99m, :haa.a + 100m] >> 0.5dt
            --  lc[:haa.a + 100m + 2dl, :hbm.yh] >> 2.5dt
        );

        # W1 - W2
        with layer = -1 track(:station :cat:ac15,
                lc[:haa.a + 100m + 1dl] << 0.5dt
            --  lc[:haa.a + 100m + 2dl] >> 0.5dt
        );

        # W5 - W7
        with layer = -1 track(:station :cat:ac15,
                lc[:haa.a + 100m + 5dl] >> 1.5dt
            --  lc[:haa.a + 100m + 6dl] >> 2.5dt
        );

        marker(:de.bbf :cat:ac15 :left, lc[:haa] << 0.5dt);
        with layer = -1 marker(:de.bf.casing :left, lc[:haa] << 0.5dt);
    }
}

with detail = [4, 5] {
    with link = "point.de.Hamburg-Hausbruch-Pbf" {
        track(:first:station :double :cat:ac15 :pax, lc[:haa.f, :hau + 1sw]);
        with layer = -1 marker(:de.bf :removed :left, lc[:hau] << 0.5dt);
        with layer = -2 marker(:de.bf.casing :left, lc[:hau] << 0.5dt);
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax, lc[:hau + 1sw, :ngr.a]);
    }


    with link = "point.de.Hamburg-Neugraben" {
        # Gl. 4 (Str. 1720 L)
        track(:first:station :cat:ac15 :pax, lc[:ngr.a, :ngr.f] << 0.5dt);

        # Gl. 5 (Str. 1720 5)
        track(:first:station :cat:ac15 :pax, lc[:ngr.a, :ngr.f] >> 0.5dt);

        # W21 - W22
        track(:station :cat:ac15,
                lc[:ngr.a + 100m] >> 0.5dt
            --  lc[:ngr.a + 100m + 1dl] << 0.5dt
        );

        # W28 - W29
        track(:station :cat:ac15,
                lc[:ngr.f - 100m - 3dl] << 0.5dt
            --  lc[:ngr.f - 100m - 2dl] >> 0.5dt
        );

        marker(:de.bf :cat:ac15 :pax :right, lc[:ngr] >> 0.5dt);
        station(:top :cat:ac15 :pax, lc[:ngr] >> 0.5dt >> 1.2sw,
            span(:bold, "Hamburg-Neugraben"),
            "1720: 179,33"
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax, lc[:ngr.f, :fis - 1sw]);
    }


    with link = "point.de.Fischbek" {
        track(:first:station :double :cat:ac15 :pax,
                lc[:fis - 1sw, :fis + 1sw]
        );
        marker(:de.hp :cat:ac15 :pax :right, lc[:fis] >> 0.5dt);
        station(:top :cat:ac15 :pax, lc[:fis] >> 0.5dt >> 1.2sw,
            "Fischbek", "181,49"
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax, lc[:fis + 1sw, :nwu - 1sw]);
    }


    with link = "point.de.Neu-Wulmstorf" {
        track(:first:station :double :cat:ac15 :pax,
                lc[:nwu - 1sw, :nwu + 1sw]
        );
        marker(:de.hp :cat:ac15 :pax :left, lc[:nwu] << 0.5dt);
        with layer = -1 marker(:de.bf :removed :left, lc[:nwu] << 0.5dt);
        station(:bottom :cat:ac15 :pax, lc[:nwu] << 0.5dt << 1.2sw,
            vbox(:center:top,
                span(:removed, "Daerstorf"),
                "Neu Wulmstorf"
            ),
            "183,49"
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax, lc[:nwu + 1sw, :bux.a]);
        with layer = 1 line_badge(:cat:ac15 :pax, lc[:nwu + 3.0km], "1720");
    }


    with link = "point.de.Buxtehude" {
        # Gl. 1 (Str. 1720 R)
        track(:first:station :cat:ac15 :pax, lc[:bux.a, :bux.f] >> 0.5dt);

        # Gl. 2 (Str. 1720 L)
        track(:first:station :cat:ac15 :pax, lc[:bux.a, :bux.f] << 0.5dt);

        # Gl. 3
        track(:station :cat:ac15 :pax,
                lc[:bux - 180m - 1.1dl, :bux - 180m - 1dl] << 0.5dt
            --  lc[:bux - 180m, :bux + 70m] << 1.5dt
        );

        # Gl. 4
        track(:station :pax,
                lc[:bux + 100m, :bux + 240m + 1dl] << 1.5dt
            --  lc[:bux + 240m + 2dl, :bux + 750m] << 2.5dt
        );

        # Gl. 5
        with layer = -1 track(:station,
                lc[:bux + 240m + 2.9dl, :bux + 240m + 3dl] << 2.5dt
            --  lc[:bux + 240m + 4dl, :bux + 600m] << 1.5dt
        );

        # W1 - W2
        track(:station :cat:ac15 :pax,
                lc[:bux - 180m - 5dl] >> 0.5dt
            --  lc[:bux - 180m - 4dl] << 0.5dt
        );

        # W12 - W11
        with layer = -1 track(:station :cat:ac15,
                lc[:bux - 180m - 3dl] << 0.5dt
            --  lc[:bux - 180m - 2dl] >> 0.5dt
        );

        # W13 - W14
        with layer = -1 track(:station :cat:ac15,
                lc[:bux + 240m] << 0.5dt
            --  lc[:bux + 240m + 1dl] << 1.5dt
        );

        # W21 - W22
        with layer = -1 track(:station :cat:ac15,
                lc[:bux.f - 100m - 3dl] >> 0.5dt
            --  lc[:bux.f - 100m - 2dl] << 0.5dt
        );

        # W30 - W31
        with layer = -1 track(:station :cat:ac15,
                lc[:bux.f - 100m - 1dl] << 0.5dt
            --  lc[:bux.f - 100m] >> 0.5dt
        );

        marker(:de.bf :cat:ac15 :pax :right, lc[:bux] >> 0.5dt);
        station(:top :cat:ac15 :pax, lc[:bux] >> 0.5dt >> 1.4sw,
            span(:bold, "Buxtehude"),
            hbox(:center:top,
                vbox(:right:top, "1720: ", "1261: ", "1269: "),
                vbox(:right:top, "190,", "??", "??"),
                vbox(:left:top, "25", "", "")
            )
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax, lc[:bux.f, :nkl - 1sw]);
    }


    with link = "point.de.Neukloster-Stade" {
        track(:first:station :double :cat:ac15 :pax,
                lc[:nkl - 1sw, :nkl + 1sw]
        );
        marker(:de.hp :cat:ac15 :pax :right, lc[:nkl] >> 0.5dt);
        with layer = -1 marker(:de.bf :gone :right, lc[:nkl] >> 0.5dt);
        station(:right :cat:ac15 :pax, lc[:nkl - 0.5sw] >> 0.5dt >> 1.2sw,
            vbox(:left:bottom,
                hbox(:left:base :removed,
                    "Neukloster ", span(:light, "(Han)")
                ),
                hbox(:left:base,
                    "Neukloster ", span(:light, "(Kr Stade)")
                )
            ),
            "193,81"
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax, lc[:nkl + 1sw, :hor.a]);
        with layer = 1 line_badge(:cat:ac15 :pax, lc[:nkl + 2.5km], "1720");
    }


    with link = "point.de.Horneburg" {
        # Gl. 2 (Str. 1720) R
        track(:first:station :cat:ac15 :pax, lc[:hor.a, :hor.f] >> 0.5dt);

        # Gl. 3 (Str. 1720) L
        track(:first:station :cat:ac15 :pax, lc[:hor.a, :hor.f] << 0.5dt);

        # W11 - W12
        with layer = -1 track(:station :cat:ac15,
                lc[:hor.a + 100m] << 0.5dt
            --  lc[:hor.a + 100m + 1dl] >> 0.5dt
        );

        # W20 - W21
        with layer = -1 track(:station :cat:ac15,
                lc[:hor.f - 100m - 1dl] >> 0.5dt
            --  lc[:hor.f - 100m] << 0.5dt
        );

        marker(:de.bf :cat:ac15 :pax :right, lc[:hor] >> 0.5dt);
        station(:right :cat:ac15 :pax, lc[:hor - 0.4sw] >> 0.5dt >> 1.4sw,
            "Horneburg", "198,96"
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax, lc[:hor.f, :dol - 1sw]);
    }


    with link = "point.de.Dollern" {
        track(:first:station :double :cat:ac15 :pax,
                lc[:dol - 1sw, :dol + 1sw]
        );
        marker(:de.hp :cat:ac15 :pax :right, lc[:dol] >> 0.5dt);
        with layer = -1 marker(:de.bf :removed :right, lc[:dol] >> 0.5dt);
        station(:right :cat:ac15 :pax, lc[:dol - 0.4sw] >> 0.5dt >> 1.4sw,
            "Dollern", "203,29"
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax, lc[:dol + 1sw, :aga - 1sw]);
    }


    with link = "point.de.Agathenburg" {
        track(:first:station :double :cat:ac15 :pax,
                lc[:aga - 1sw, :aga + 1sw]
        );
        marker(:de.hp :cat:ac15 :pax :left, lc[:aga] << 0.5dt);
        station(:left :cat:ac15 :pax, lc[:aga - 0.4sw] << 0.5dt << 2.0sw,
            "Agathenburg", "206,06"
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat:ac15 :pax, lc[:aga + 1sw, :sta.a]);
        with layer = 1 line_badge(:cat:ac15 :pax, lc[:aga + 2.0km], "1720");
    }


    with link = "point.de.Stade" {
        # Gl. 1 (Str. 1720 R)
        track(:first:station :cat:ac15 :pax, lc[:sta.a, :sta.f] >> 0.5dt);

        # Gl. 2 (Str. 1720 L)
        track(:first:station :cat:ac15 :pax, lc[:sta.a, :sta.f] << 0.5dt);

        # Gl. 3
        track(:station :cat:ac15 :pax,
                lc[:sta - 451m, :sta - 450m] << 0.5dt
            --  lc[:sta - 450m + 1dl, :sta] << 1.5dt
        );

        # Gl. 7
        with layer = -1 track(:station :cat:ac15,
                lc[:sta.a + 100m + 1dl, :sta - 0.6sw - 1dl] >> 1.5dt
        );

        # Gl. 8
        with layer = -1 track(:station :cat:ac15,
                lc[:fhes + 1.9dl, :fhes + 2dl] >> 1.5dt
            --  lc[:fhes + 3dl, :sta - 0.6sw - 2dl] >> 2.5dt
            --  lc[:sta - 0.6sw, :sta - 0.59sw] >> 0.5dt
        );

        # Gl. 10
        with layer = -2 track(:station,
                lc[:sta - 600m + 1dl, :sta - 0.6sw - 3dl] >> 3.5dt
        );

        # Gl. 12
        track(:station,
                lc[:sta - 601m, :sta - 600m] >> 2.5dt
            --  lc[:sta - 600m + 2dl, :sta - 0.6sw - 4dl] >> 4.5dt
            --  lc[:sta - 0.6sw - 2dl, :sta - 0.6sw - 1.99dl] >> 2.5dt
        );

        # Gl. 22
        with layer = -1 track(:station :cat:ac15,
                lc[:sta - 580m, :sta - 450m + 1dl] << 2.5dt
            --  lc[:sta - 450m + 2dl, :sta - 450m + 2.1dl] << 1.5dt
        );

        # Gl. 24
        with layer = -1 track(:station :cat:ac15,
                lc[:sta - 550m, :sta - 450m + 2dl] << 3.5dt
            --  lc[:sta - 450m + 4dl, :sta - 450m + 4.1dl] << 1.5dt
        );

        # Gl. 400 (Str. 1260)
        with layer = -2 track(:second:station,
                lc[:fhes - 2dl, :fhes - 1dl] << 1.5dt
            --  lc[:fhes, :fhes + 0.1dl] << 0.5dt
        );

        # W1 - W2
        track(:station :cat:ac15 :pax,
                lc[:fhes - 3dl] >> 0.5dt
            --  lc[:fhes - 2dl] << 0.5dt
        );

        # W4 - W5
        with layer = -1 track(:station :cat:ac15,
                lc[:fhes + 1dl] << 0.5dt
            --  lc[:fhes + 2dl] >> 0.5dt
        );

        # W6 - W7
        with layer = -1 track(:station :cat:ac15,
                lc[:fhes + 3dl] >> 0.5dt
            --  lc[:fhes + 4dl] >> 1.5dt
        );

        # W27 - W28
        with layer = -1 track(:station :cat:ac15,
                lc[:sta.f - 100m - 3dl] << 0.5dt
            --  lc[:sta.f - 100m - 2dl] >> 0.5dt
        );

        # W29 - W30
        with layer = -1 track(:station :cat:ac15,
                lc[:sta.f - 100m - 1dl] >> 0.5dt
            --  lc[:sta.f - 100m] << 0.5dt
        );

        # W100 - W101
        with layer = -1 track(:station :cat:ac15,
                lc[:sta.a + 100m] << 0.5dt
            --  lc[:sta.a + 100m + 1dl] >> 0.5dt
        );

        # W102 - W103
        with layer = -1 track(:station :cat:ac15,
                lc[:sta.a + 100m + 2dl] >> 0.5dt
            --  lc[:sta.a + 100m + 3dl] >> 1.5dt
        );

        marker(:de.bf :cat:ac15 :pax :right, lc[:sta] >> 0.5dt);
        station(:top :cat:ac15 :pax, lc[:sta] >> 0.5dt >> 1.4sw,
            span(:bold, "Stade"),
            hbox(:center:top,
                vbox(:right:top, "1720: ", "1260: "),
                vbox(:right:top, "211,", "26,"),
                vbox(:left:top, "18", "55")
            )
        );
    }


    with link = "line.de.1720" {
        with layer = -1 track(:first :double :pax, lc[:sta.f, :ham - 1sw]);
        with layer = 1 line_badge(:pax, lc[:sta + 1.5km], "1720");
    }


    with link = "point.de.Hahle" {
        with layer = -1 marker(:de.bk :removed :left, lc[:hah] << 0.5dt);
        station(:bottom :removed, lc[:hah] << 0.5dt << 1.1sw,
            "Hahle", "214,38"
        );
    }


    with link = "point.de.Hammah" {
        track(:first:station :double :pax, lc[:ham - 1sw, :ham + 1sw]);
        marker(:de.hp :pax :left, lc[:ham] << 0.5dt);
        with layer = -1 marker(:de.bf :removed :left, lc[:ham] << 0.5dt);
        station(:bottom :pax, lc[:ham] << 0.5dt << 1.3sw,
            "Hammah",
            hbox(:center:base,
                "218,71 ", span(:removed, "← 218,68")
            )
        );
    }


    with link = "line.de.1720" {
        track(:first :double :pax, lc[:ham + 1sw, :him - 1sw]);
    }


    with link = "point.de.Himmelpforten" {
        # Str. 1720 R
        track(:first:station :pax,
                lc[:him - 1sw, :him.f - 100m - 1dl] >> 0.5dt
            --  lc[:him.f - 100m, :him.f - 99m] << 0.5dt
        );
        with layer = -1 track(:first:station :removed,
                lc[:him.f - 100m - 1dl, :him.f] >> 0.5dt
        );

        # Str. 1720 L
        track(:first:station :pax, lc[:him - 1sw, :him.f] << 0.5dt);

        marker(:de.hp :pax :left, lc[:him] << 0.5dt);
        marker(:de.uest :pax :left, lc[:him] << 0.5dt);
        with layer = -1 marker(:de.bf :gone :left, lc[:him] << 0.5dt);
        station(:bottom :pax, lc[:him] << 0.5dt << 1.4sw,
            "Himmelpforten", "222,63"
        );
    }


    with link = "line.de.1720" {
        with layer = -1 track(:first :removed,
                lc[:him.f, :ost - 250m] >> 0.5dt
        );
        track(:first:pax,
                lc[:him.f, :ost - 250m - 1dl] << 0.5dt
            --  lc[:ost - 250m, :ost - 1sw] >> 0.5dt
        );
        with layer = -1 track(:first :removed,
                lc[:ost - 250m - 1dl, :ost - 1sw] << 0.5dt
        );
    }


    with link = "point.de.Ostebrücke" {
        track(:first:station :pax, lc[:ost - 1sw, :ost + 170m + 1sw] >> 0.5dt);
        track(:first:station :removed,
                lc[:ost - 1sw, :ost + 170m + 1sw] << 0.5dt
        );

        with layer = -1 marker(:de.bk :removed :right, lc[:ost] >> 0.5dt);
        station(:top :removed, lc[:ost] >> 0.5dt >> 1.2sw,
            "Ostebrücke", "226,11"
        );

        with layer = -1 marker(
            :de.bk :gone :left, lc[:ost + 170m] << 0.5dt
        );
        station(:bottom :gone, lc[:ost + 170m] << 0.5dt << 1.2sw,
            "Oste Drehbrücke", "226,29"
        );
    }


    with link = "line.de.1720" {
        track(:first :pax,
                lc[:ost + 170m + 1sw, :ost + 500m] >> 0.5dt
            --  lc[:ost + 500m + 1dl, :hec - 1sw] << 0.5dt
        );
        with layer = -1 track(:first:removed,
                lc[:ost + 170m + 1sw, :ost + 500m + 1dl] << 0.5dt
        );
        with layer = -1 track(:first:removed,
                lc[:ost + 500m, :hec - 1sw] >> 0.5dt
        );
    }


    with link = "point.de.Hechthausen" {
        # Str. 1720 R
        with layer = -1 track(:first:station :removed,
                lc[:hec - 1sw, :hec.f - 100m] >> 0.5dt
        );
        track(:first:station :pax,
                lc[:hec.f - 100m - 1.1dl, :hec.f - 100m - 1dl] << 0.5dt
            --  lc[:hec.f - 100m, :hec.f] >> 0.5dt
        );

        # Str. 1720 L
        track(:first:station :pax, lc[:hec - 1sw, :hec.f] << 0.5dt);

        marker(:de.hp :pax :right, lc[:hec] >> 0.5dt);
        marker(:de.uest :pax :right, lc[:hec] >> 0.5dt);
        marker(:de.hpext :pax :right, lc[:hec] << 0.5dt);
        marker(:statdt :pax :right, lc[:hec] << 0.5dt);
        with layer = -1 marker(:de.bf :gone :right, lc[:hec] >> 0.5dt);
        station(:left :pax, lc[:hec - 0.4sw] << 0.5dt << 1.0sw,
            "Hechthausen",
            hbox(:center:base, "228,43 ", span(:removed, "← 228,40"))
        );
    }


    with link = "line.de.1720" {
        track(:first :double :pax, lc[:hec.f, :hem - 1sw]);
        with layer = 1 line_badge(:pax, lc[:hec + 3.3km], "1720");
    }


    with link = "point.de.Hemmoor" {
        track(:first:station :double :pax, lc[:hem - 1sw, :hem + 1sw]);
        marker(:de.hp :pax :right, lc[:hem] >> 0.5dt);
        with layer = -1 marker(:de.bf :removed :right, lc[:hem] >> 0.5dt);
        label(lc[:hem - 0.1sw] >> 0.5dt >> 1.6sw,
            vbox(:left:middle :pax,
                span(:medium:removed, "Basbeck-Osten"),
                hbox(:left:top,
                    vbox(:center:top,
                        span(:medium, "Hemmoor"),
                        span(:xsmall, "234,97")
                    )
                )
            )
        );
    }


    with link = "line.de.1720" {
        track(:first :double :pax, lc[:hem + 1sw, :war - 1sw]);
    }


    with link = "point.de.Warstade" {
        track(:first:station :double :pax, lc[:war - 1sw, :war + 1sw]);
        with layer = -1 marker(:de.bf :removed :left, lc[:war] << 0.5dt);
        station(:left :pax :removed, lc[:war - 0.2sw] << 0.5dt << 1.8sw,
            "Warstade-Hemmoor",
            "238,24 ← 238,18"
        );
    }


    with link = "line.de.1720" {
        track(:first :double :pax, lc[:war + 1sw, :wig - 1sw]);
    }


    with link = "point.de.Wingst" {
        track(:first:station :double :pax, lc[:wig - 1sw, :wig + 1sw]);
        marker(:de.hp :pax :right, lc[:wig] >> 0.5dt);
        with layer = -1 marker(:de.bf :gone :right, lc[:wig] >> 0.5dt);
        label(lc[:wig + 0.1sw] >> 0.5dt >> 1.5sw,
            vbox(:left:middle :pax,
                span(:medium:removed, "Höftgrube"),
                hbox(:left:top,
                    vbox(:center:top,
                        span(:medium, "Wingst"),
                        span(:xsmall, "243,18")
                    )
                )
            )
        );
    }


    with link = "line.de.1720" {
        track(:first :double :pax, lc[:wig + 1sw, :cad.a]);
    }


    with link = "point.de.Cadenberge" {
        # Gl. 1 (Str. 1720 R)
        track(:first:station :pax, lc[:cad.a, :cad.f] >> 0.5dt);

        # Gl. 2 (Str. 1720 L)
        track(:first:station :pax, lc[:cad.a, :cad.f] << 0.5dt);

        # W1 - W2
        track(:station,
                lc[:cad.a + 100m] << 0.5dt
            --  lc[:cad.a + 100m + 1dl] >> 0.5dt
        );

        # W11 - W12
        track(:station,
                lc[:cad.f - 100m - 1dl] >> 0.5dt
            --  lc[:cad.f - 100m] << 0.5dt
        );

        marker(:de.bf :pax :right, lc[:cad] >> 0.5dt);
        station(:top :pax, lc[:cad - 0.2sw] >> 0.5dt >> 1.4sw,
            "Cadenberge", "247,05"
        );
    }


    with link = "line.de.1720" {
        track(:first :double :pax, lc[:cad.f, :nha - 1sw]);
    }


    with link = "point.de.Neuhaus-Oste" {
        track(:first:station :double :pax, lc[:nha - 1sw, :nha + 1sw]);
        marker(:de.hp :removed :right, lc[:nha] >> 0.5dt);
        marker(:de.anst :removed :right, lc[:nha] >> 0.5dt);
        with layer = -1 marker(:de.bf :gone :right, lc[:nha] >> 0.5dt);
        station(:right :removed, lc[:nha - 0.5sw] >> 0.5dt >> 1.4sw,
            hbox(:left:base, "Neuhaus ", span(:light, "(Oste)")),
            "250,91"
        );
    }


    with link = "line.de.1720" {
        track(:first :double :pax, lc[:nha + 1sw, :ose - 0.5sw]);
    }


    with link = "point.de.Otterndorf-Osterende" {
        track(:first:station :double :pax, lc[:ose - 0.5sw, :ose + 0.5sw]);
        with layer = -1 marker(:de.bk :removed :right, lc[:ose] >> 0.5dt);
        station(:top :removed, lc[:ose] >> 0.5dt >> 1.2sw,
            "Osterende", "256,64"
        );
    }


    with link = "line.de.1720" {
        track(:first :double :pax, lc[:ose + 0.5sw, :ott - 1sw]);
    }


    with link = "point.de.Otterndorf" {
        track(:first:station :double :pax, lc[:ott - 1sw, :ott + 1sw]);
        marker(:de.hp :pax :right, lc[:ott] >> 0.5dt);
        with layer = -1 marker(:de.bf :removed :right, lc[:ott] >> 0.5dt);
        station(:top :pax, lc[:ott] >> 0.5dt >> 1.3sw,
            "Otterndorf", "258,89"
        );
    }


    with link = "line.de.1720" {
        track(:first :double :pax, lc[:ott + 1sw, :wee - 0.5sw]);
    }


    with link = "point.de.Otterndorf-Westerende" {
        track(:first:station :double :pax, lc[:wee - 0.5sw, :wee + 0.5sw]);
        with layer = -1 marker(:de.bk :right :removed, lc[:wee] >> 0.5dt);
        station(:top :removed, lc[:wee] >> 0.5dt >> 1.2sw,
            "Westerende", "261,93"
        );
    }


    with link = "line.de.1720" {
        track(:first :double :pax, lc[:wee + 0.5sw, :abr - 1sw]);
    }


    with link = "point.de.Altenbruch" {
        track(:first:station :double :pax, lc[:abr - 1sw, :abr + 1sw]);
        with layer = -1 marker(:de.hp :removed :left, lc[:abr] << 0.5dt);
        with layer = -2 marker(:de.bf :gone :left, lc[:abr] << 0.5dt);
        station(:left :removed, lc[:abr - 0.5sw] << 0.5dt << 2.0sw,
            "Altenbruch", "267,08"
        );
    }


    with link = "line.de.1720" {
        track(:first :double :pax, lc[:abr + 1sw, :cux.a]);
        with layer = 1 line_badge(:pax, lc[:abr + 2.0km], "1720");
    }


    with link = "point.de.Cuxhaven-Groden" {
        # Gl. 1 (Str. 1720 R)
        track(:first:station :pax, lc[:cux.a, :gro + 200m] >> 0.5dt);

        # Gl. 2 (Str. 1720 L)
        track(:first:station :pax, lc[:cux.a, :gro + 200m] << 0.5dt);

        # Gl. 201 (Str. 1264)
        with layer = -1 track(:station,
                lc[:gro - 0.1dl, :gro] >> 0.5dt
            --  lc[:gro + 1dl, :gro + 2dl] >> 1.5dt
        );

        # W401 - W402
        with layer = -1 track(:station,
                lc[:gro - 2dl] << 0.5dt
            --  lc[:gro - 1dl] >> 0.5dt
        );
    }


    with link = "point.de.Cuxhaven-CF" {
        # Gl. 1 (Str. 1720 R)
        track(:first:station :pax, lc[:gro + 200m, :cuf + 6dl] >> 0.5dt);

        # Gl. 2 (Str. 1720 L)
        track(:first:station :pax, lc[:gro + 200m, :cuf + 6dl] << 0.5dt);

        # Gl. 18
        with layer = -1 track(:station, lc[:cuf - 550m, :cuf + 6dl] >> 1.5dt);

        # Str. 1310
        track(:second:station :pax,
                path("d4.de.a.1310")[:cux.b, :cux.xb - 1.5dt]
            ..  lc[:cuf - 2dl, :cuf + 2dl] << 1.5dt
            --  lc[:cuf + 3dl, :cuf + 3.1dl] << 0.5dt
        );

        # W10 - W11
        with layer = -1 track(:station,
                lc[:cuf + 1dl] << 0.5dt
            --  lc[:cuf + 2dl] >> 0.5dt
        );

        # W12 - W14
        with layer = -1 track(:station,
                lc[:cuf + 3dl] << 0.5dt
            --  lc[:cuf + 5dl] >> 1.5dt
        );

        with layer = -1 marker(:de.bft :left, lc[:cuf] << 1.5dt);
        station(:left, lc[:cuf] << 1.5dt << 1.7sw,
            "C. CF", "??"
        );
    }


    with link = "point.de.Cuxhaven-Gbf" {
        # Gl. 18
        track(:station, lc[:cuf + 6dl, :cug + 850m] >> 1.5dt);

        # Gl. 21
        track(:station,
                lc[:cug - 50m + 1dl, :cug + 300m + 1dl] >> 2.5dt
        );

        # Gl. 23
        track(:station,
                lc[:cug - 50m - 0.1dl, :cug - 50m] >> 1.5dt
            --  lc[:cug - 50m + 2dl, :cug + 300m] >> 3.5dt
        );

        # Gl. 25
        track(:station,
                lc[:cug - 50m - 2.1dl, :cug - 50m - 2dl] >> 1.5dt
            --  lc[:cug - 50m + 1dl, :cug + 300m - 1dl] >> 4.5dt
            --  lc[:cug + 300m + 2dl, :cug + 300m + 2.1dl] >> 1.5dt
        );

        # Gl. 28
        track(:station,
                lc[:cug - 50m - 4.1dl, :cug - 50m - 4dl] >> 1.5dt
            --  lc[:cug - 50m, :cug + 300m] >> 5.5dt
            --  lc[:cug + 300m + 4dl, :cug + 300m + 4.1dl] >> 1.5dt
        );

        marker(:de.bft :right, lc[:cug] >> 5.5dt);
    }


    with link = "point.de.Cuxhaven" {
        # Gl. 1 (Str. 1720 R)
        track(:first:station :pax, lc[:cuf + 6dl, :cux] >> 0.5dt);

        # Gl. 2 (Str. 1720 L)
        track(:first:station :pax, lc[:cuf + 6dl, :cux] << 0.5dt);

        # Gl. 3
        track(:station :pax,
                lc[:cus + 2.9dl, :cus + 3dl] << 0.5dt
            --  lc[:cus + 4dl, :cux] << 1.5dt
        );

        # Gl. 10
        with layer = -1 track(:station,
                lc[:cus - 500m, :cus - 2dl] << 3.5dt
            --  lc[:cus, :cus + 0.1dl] << 1.5dt
        );

        # Gl. 12
        with layer = -1 track(:station,
                lc[:cus - 500m, :cus - 3dl] << 2.5dt
            --  lc[:cus - 2dl, :cus - 1.9dl] << 1.5dt
        );

        # Gl. 15
        with layer = -1 track(:station,
                lc[:cuf + 6dl, :cus + 2.5dl] << 1.5dt
        );

        # W52 - W53
        track(:station :pax,
                lc[:cus] >> 0.5dt
            --  lc[:cus + 1dl] << 0.5dt
        );

        # W54 - W55
        with layer = -1 track(:station,
                lc[:cus + 1dl] << 1.5dt
            --  lc[:cus + 2dl] << 0.5dt
        );

        # W59 - W60
        track(:station :pax,
                lc[:cus + 4dl] << 0.5dt
            --  lc[:cus + 5dl] >> 0.5dt
        );

        marker(:de.bf :pax :top, lc[:cux] << 0.5dt);
        station(:left :pax, lc[:cux] - (1.4sw, 0.2sw),
            hbox(:right:base,
                span(:bold, "Cuxhaven "),
                span(:bold :removed, "Stadt")
            ),
            hbox(:center:top,
                vbox(:right:top, "1720: ", "1310: "),
                vbox(:right:top, "273,", "228,"),
                vbox(:left:top, "05", "35")
            )
        );
    }
}

