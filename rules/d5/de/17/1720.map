# DE 1720.  Lehrte - Cuxhaven
#
let lehcux = path("path.de.1720");

with detail = 5 {

    with link = "line.de.1720" {
        # Str. 1720 L/R
        track(:first :double :cat, lehcux[:meh + 300m, :fbre - 350m]);

        # Str. 1720 R
        track(:first :cat :tight,
                lehcux[:fbre - 350m, :fbre - 340m] >> 0.5dt
            ..  lehcux[:fbre + 100m, :hrb - 450m] >> 1.5dt
        );

        # Str. 1720 L
        track(:first :cat :tight :flip,
                lehcux[:fbre - 350m, :fbre - 340m] << 0.5dt
            ..  lehcux[:fbre + 80m, :hrs - 180m] << 2.5dt
            ..  lehcux[:hrb - 451m, :hrb - 450m] << 1.5dt
        );
    }


    # point.de.Hamburg-Harburg: de.2200


    with link = "line.de.1720" {
        track(:first :double :cat, lehcux[:har.f + 11dt, :unt - 200m]);
    }


    with link = "point.de.Hamburg-Unterelbe" {
        let untuns = path("path.de.1252");

        let w1 = lehcux[:unt - 101m, :unt - 100m] << 0.5dt;
        let w2 = lehcux[:unt - 20m, :unt - 19m] >> 0.5dt;
        let w3 = lehcux[:unt - 1m, :unt] >> 0.5dt;
        let w4 = lehcux[:unt + 99m, :unt + 100m] >> 1.5dt;
        let w5 = untuns[:unt + 209m, :unt + 210m];
        let w6 = untuns[:uns.a - 66m, :uns.a - 65m] << 1dt;
        let w7 = untuns[:uns.a - 5m, :uns.a - 4m];

        # Gl. 1 (Str. 1720 L)
        track(:first:station :cat, lehcux[:unt - 200m, :unt + 200m] << 0.5dt);

        # Gl. 2 (Str. 1720 R)
        track(:first:station :cat, lehcux[:unt - 200m, :unt + 200m] >> 0.5dt);

        # Gl. 4
        track(:station, lehcux[:unt + 20m, :unt + 100m] >> 1.5dt);

        # Gl. 5
        track(:station :cat,
                w5
            ..  untuns[:unt + 320m, :uns.a] << 1dt
        );

        # Gl. 6 (Str. 1252)
        track(:second:station :cat,
                w3
            ..  w4
            ..  untuns[:unt + 210m, :uns.a]
        );

        # W1 - W2
        track(:station :cat, w1 .. w2);

        # W6 - W7
        track(:station :cat, w6 .. w7);

        marker(:de.bbf :left, lehcux[:unt] << 0.5dt);
        with layer = -1 marker(:de.bf :removed :left, lehcux[:unt] << 0.5dt);
        label(lehcux[:unt] << 0.5dt << 1.5sw + (1.5sw, 0sw),
            hbox(:right:top,
                vbox(:right:top,
                    span(:medium :bold :removed, "Harburg-Wilhelmsburg U E"),
                    vbox(:center:top,
                        span(:medium :bold, "Hamburg Unterelbe"),
                        hbox(:center:top :xsmall,
                            vbox(:right:top, "1252: ", "1720: "),
                            vbox(:right:top, "0,", "170,"),
                            vbox(:left:top, "00", "78")
                        )
                    )
                )
            )
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat, lehcux[:unt + 200m, :tem - 1sw]);
    }


    with link = "point.de.Hamburg-Tempowerk" {
        track(:first:station :double :cat, lehcux[:tem - 1sw, :tem + 0.55sw]);
        with layer = -1 marker(:de.hp :removed :right, lehcux[:tem] >> 0.5dt);
    }


    with link = "point.de.Heimfeld" {
        track(:first:station :double :cat,
                lehcux[:tem + 0.55sw, :tem + 2.1sw]
        );
        with layer = -1 marker(
            :de.bk :removed :right, lehcux[:tem + 1.1sw] >> 0.5dt
        );
    }


    with link = "line.de.1720" {
        track(:first :double :cat, lehcux[:tem + 2.1sw, :haa.a]);
    }


    with link = "point.de.Hamburg-Hausbruch" {
        let seldra = path("path.de.1253");

        let w1   = lehcux[:haa - 116m, :haa - 115m] << 0.5dt;
        let w2   = lehcux[:haa - 30m, :haa - 29m] >> 0.5dt;
        let w3   = lehcux[:haa - 0.1dl, :haa] >> 0.5dt;
        let w5   = lehcux[:haa + 124m, :haa + 125m] >> 1.5dt;
        let w6   = lehcux[:haa - 146m, :haa - 145m] >> 0.5dt;
        let w7   = lehcux[:haa + 195m, :haa + 196m] >> 2.5dt;
        let w16  = lehcux[:haa.f - 351m, :haa.f - 350m] >> 0.5dt;
        let w17  = lehcux[:haa.f - 275m, :haa.f - 274m] << 0.5dt;

        # Gl. 1
        track(:first:station :cat,
                lehcux[:haa.a, :haa.f] << 0.5dt
        );

        # Gl. 2
        track(:first:station :cat,
                lehcux[:haa.a, :haa.f] >> 0.5dt
        );

        # Gl. 3
        track(:second:station :cat,
                w3
            ..  lehcux[:haa + 100m, :haa + 300m] >> 1.5dt
        );

        # Gl. 4
        track(:second:station :cat,
                w6
            ..  lehcux[:haa - 30m, :haa] >> 1.5dt
            ..  lehcux[:haa + 100m, :haa + 300m] >> 2.5dt
        );

        # W1 - W2
        track(:station :cat, w1 .. w2);

        # W5 - W7
        track(:station :cat, w5 .. w7);

        # W16 - W17
        track(:station :cat, w16 .. w17);

        marker(:de.bbf :right, lehcux[:haa] >> 1.5dt);
        marker(:de.bft :right, lehcux[:hbm] >> 4.5dt);
    }
}

