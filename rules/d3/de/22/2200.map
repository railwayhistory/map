#
#

with detail = 3 {
    let wanham = path("path.de.2200");
    # ...

    with link = "line.de.2200" {
        track(:first :cat :flip :tight,
                wanham[:spr + 1ssw, :buc - 1ssw] << 1dt
        );
        track(:first :cat :tight, wanham[:spr + 1ssw, :buc - 1ssw] >> 1dt);
    }
    with link = "line.de.1283" {
        track(:first :cat :tight, wanham[:spr + 1ssw, :buc - 1ssw]);
    }

    with link = "point.de.Buchholz-Nordheide" {
        # Str. 2200 L
        track(:first:station :cat,
                wanham[:buc - 1ssw, :buc + 0.5ssw] << 1dt
            ..  wanham[:buc + 0.5ssw + 1dl, :buc + 1.5ssw] << 0.5dt
        );

        # Str. 1283
        track(:first:station :cat,
                wanham[:buc - 1ssw, :buc + 0.5ssw]
            ..  wanham[:buc + 0.5ssw + 1dl, :buc + 1.5ssw] << 0.5dt
        );
        track(:first:station :cat,
                wanham[:buc + 0.5ssw]
            --  wanham[:buc + 0.5ssw + 1dl] >> 0.5dt
        );

        # Str. 2200 R
        track(:first:station :cat,
                wanham[:buc - 1ssw, :buc + 0.5ssw] >> 1dt
            ..  wanham[:buc + 0.5ssw + 1dl, :buc + 1.5ssw] >> 0.5dt
        );

        # 1712
        track(:first:station,
                wanham[:buc - 1ssw, :buc - 0.5ssw] >> 1dt >> 1ssw
        );

        # 1300
        with layer = -1 track(:second:station :removed,
                wanham[:buc - 1ssw, :buc - 0.5ssw] >> 2dt >> 1ssw
        );

        # 1280
        track(:first:station :double :cat,
                wanham[:buc - 0.5ssw, :buc + 0.5ssw] >> 1.5dt >> 1ssw
        );

        marker(:de.bf :right, wanham[:buc] >> 1dt);
        slabel(:left, wanham[:buc + 1ssw] << 2.5dt,
            hbox(:center:base,
                span(:bold, "Buchholz "),
                span(:regular, "(Nordh)")
            )
        );
    }

    with link = "line.de.2200" {
        track(:first :double :cat, wanham[:buc + 1.5ssw, :hga.a]);
        with layer = 1 line_badge(:open, wanham[:kle - 1.7km], "2200");
    }

    with link = "point.de.Bünsen" {
        with layer = -1 marker(:de.bk :removed :left, wanham[:bun] << 0.5dt);
    }

    with link = "point.de.Klecken" {
        marker(:de.hp :left, wanham[:kle] << 0.5dt);
        with layer = -1 marker(:de.bf :removed :left, wanham[:kle] << 0.5dt);
        slabel(:left, wanham[:kle - 0.6ssw] << 0.5dt << 1.6ssw, "Klecken");
    }

    with link = "point.de.Eddelsen" {
        with layer = -1 marker(:de.bk :removed :left, wanham[:edd] << 0.5dt);
    }

    with link = "point.de.Hittfeld" {
        marker(:de.hp :right, wanham[:hit] >> 0.5dt);
        with layer = -1 marker(:de.bf :removed :right, wanham[:hit] >> 0.5dt);
        slabel(:left, wanham[:hit - 0.7ssw] << 1.5dt, "Hittfeld");
    }

    with link = "point.de.Glüsingen-Harburg" {
        with layer = -1 marker(:de.bk :removed :right, wanham[:glu] >> 0.5dt);
    }

}

# Großraum Hamburg
#
with detail = 3 {
    let wanham = path("metro.de.hmb.2200");

    with link = "point.de.Hamburg-Harburg" {
        let lehcux = path("metro.de.hmb.1720");

        # Str. 1280
        track(:first:station :double :cat,
                wanham[:har.a, :har] >> 2dt
            ..  wanham[:har.f - 1dl, :har.f] >> 1dt
        );

        # Str. 1720
        track(:first:station :double :cat,
                lehcux[:har.a - 1200m, :har.a]
        );
        track(:first:station :double :cat,
                wanham[:har - 0.1dl, :har] << 2dt
            ..  lehcux[:unt - 0.1dl, :unt]
        );

        # Str. 2200
        track(:first:station :double :cat,
                wanham[:hga, :har]
            ..  wanham[:har.f - 1dl, :har.f] << 1dt
        );

        # Str. 1255
        track(:first:station :double :cat,
                wanham[:har.a, :har] << 2dt
            ..  wanham[:har.f - 1dl, :har.f] << 3dt
        );
    }

    with link = "line.de.2200" {
        track(:first :double :cat,
                wanham[:har.f, :frot + 1dt] << 1dt
            ..  wanham[:ham.a, :ham.a + 0.1dl] << 2dt
        );
    }

    with link = "point.de.Hamburg-Veddel" {
        marker(:de.abzw :left, wanham[:ved] << 1.5dt);
    }

}
