# RU KG 5.  Калининград-Пассажирский - Багратионовск
#
let kalbag = path("path.ru.kg.5");

with detail = 3 {
    with link = "line.ru.kg.5" {
        let kalter = path("path.ru.kg.2");

        track(:first,
                kalter[:abag, :abag + 1m] >> 0.5dt
            ..  kalbag[:aa + 200m, :op4 - 1ssw]
        );
    }

    with link = "point.ru.kg.5.Оп-4" {
        track(:first:station, kalbag[:op4 - 1ssw, :op4 + 1ssw]);
        marker(:de.hp :right, kalbag[:op4]);
        slabel(:left, kalbag[:op4 + 0.6ssw] >> 1.4ssw, "4 км");
    }

    with link = "line.ru.kg.5" {
        track(:first, kalbag[:op4 + 1ssw, :dse - 1ssw]);
    }

    with link = "point.ru.Дзержинская-Новая" {
        track(:first:station, kalbag[:dse - 1ssw, :dse + 1ssw]);
        marker(:de.bf :left, kalbag[:dse]);
        slabel(:left, kalbag[:dse + 0.6ssw] >> 1.0dt,
            "Д.-Н."
        );
    }

    with link = "line.ru.kg.5" {
        track(:first, kalbag[:dse + 1ssw, :op6 - 1ssw]);
    }

    with link = "point.ru.kg.5.Оп-6" {
        track(:first:station, kalbag[:op6 - 1ssw, :op6 + 1ssw]);
        marker(:de.hp :left, kalbag[:op6]);
        slabel(:right, kalbag[:op6 + 0.6ssw] << 1.4ssw, "6 км");
    }

    with link = "line.ru.kg.5" {
        track(:first, kalbag[:op6 + 1ssw, :otw - 1ssw]);
        with layer = 1 line_badge(:open, kalbag[:op6 + 1.8km], "КГ 5");
    }

    with link = "point.ru.Отважное" {
        track(:first:station, kalbag[:otw - 1ssw, :otw + 1ssw]);
        marker(:de.hp :left, kalbag[:otw]);
        with layer = -1 marker(:de.bf :removed :left, kalbag[:otw]);
        slabel(:right, kalbag[:otw + 0.6ssw] << 1.4ssw, "Отважное");
    }

    with link = "line.ru.kg.5" {
        track(:first, kalbag[:otw + 1ssw, :wla - 1ssw]);
    }

    with link = "point.ru.Владимиров" {
        track(:first:station, kalbag[:wla - 1ssw, :wla + 1ssw]);
        marker(:de.bf :left, kalbag[:wla]);
        slabel(:right, kalbag[:wla + 1.0ssw] << 1.4ssw,
            vbox(:center:bottom :bold,
                span(:gone, "Tharau"),
                span(:open, "Владимиров")
            )
        );
    }

    with link = "line.ru.kg.5" {
        track(:first, kalbag[:wla + 1ssw, :op18 - 1ssw]);
    }

    with link = "point.ru.kg.5.Оп-18" {
        track(:first:station, kalbag[:op18 - 1ssw, :op18 + 1ssw]);
        marker(:de.hp :right, kalbag[:op18]);
        slabel(:left, kalbag[:op18 + 0.4ssw] >> 1.8ssw, "18 км");
    }

    with link = "line.ru.kg.5" {
        track(:first, kalbag[:op18 + 1ssw, :op20 - 1ssw]);
    }


    with link = "point.ru.kg.5.Оп-20" {
        track(:first:station, kalbag[:op20 - 1ssw, :op20 + 1ssw]);
        marker(:de.hp :left, kalbag[:op20]);
        slabel(:right, kalbag[:op20 + 0.8ssw] << 1.6ssw, "20 км");
    }


    with link = "line.ru.kg.5" {
        track(:first, kalbag[:op20 + 1ssw, :op21 - 1ssw]);
    }


    with link = "point.ru.kg.5.Оп-21" {
        track(:first:station, kalbag[:op21 - 1ssw, :op21 + 1ssw]);
        marker(:de.hp :left, kalbag[:op21]);
        slabel(:right, kalbag[:op21 + 0.8ssw] << 1.6ssw, "21 км");
    }

    with link = "line.ru.kg.5" {
        track(:first, kalbag[:op21 + 1ssw, :str - 1ssw]);
    }

    with link = "point.ru.Стрельня-Новая" {
        track(:first:station, kalbag[:str - 1ssw, :str + 1ssw]);
        marker(:de.hp :right, kalbag[:str]);
        with layer = -1 marker(:de.bf :removed :left, kalbag[:str]);
        slabel(:left, kalbag[:str + 0.2ssw] >> 1.8ssw, "Стрельня-Новая");
    }

    with link = "line.ru.kg.5" {
        track(:first, kalbag[:str + 1ssw, :bag - 1ssw]);
        with layer = 1 line_badge(:open, kalbag[:str + 7.0km], "КГ 5");
    }

    with link = "point.ru.Багратионовск" {
        track(:first:station, kalbag[:bag - 1ssw, :bag + 1ssw]);
        marker(:de.bf :right, kalbag[:bag]);
        slabel(:left, kalbag[:bag + 1.0ssw] >> 1.6ssw,
            vbox(:right:bottom :bold,
                span(:gone, "Preußisch Eylau"),
                span(:open, "Багратионовск")
            )
        );
    }

    with link = "line.ru.kg.5" {
        track(:first :closed, kalbag[:bag + 1ssw, :gr - 0.5ssw]);
    }


    with link = "point.int.Багратионовск-Głomno" {
        track(:first :closed, kalbag[:gr - 0.5ssw, :gr]);
        track(:first :removed, kalbag[:gr, :gr + 0.5ssw]);
        marker(:de.dirgr :closed :left, kalbag[:gr]);
        marker(:de.dirgr :closed :right, kalbag[:gr]);
    }
}

