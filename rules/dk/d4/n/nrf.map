# DK NRF.  Nyborg - Ringe - Faaborg
#
let nf = path("d3.dk.nrf");

with detail = 4,
     railway = :first :pax :removed
{
    # point.dk.Nyborg-Færge  dk.NYB

    with link = "line.dk.NRF" {
        track(:ror, nf[:nyb.yn, :nyb.yr] << 1.5mo);
        track(:ror,
                nf[:nyb.yr - 0.1dl, :nyb.yr] << 1.5mo
            ..  nf[:nyb.xr + 2mo, :nyb.xr + 2.01mo]
        );
        track(nf[:nyb.xr + 2mo, :nyb.yr + 2.7km]);
        line_label(:right:s, nf[:nyb.yr + 2.7km] >> 0.5mt, "NRF");
        track(nf[:nyb.yr + 2.7km, :lam - 0.5sw]);
    }

    with link = "point.dk.Lamdrup", railway = :station {
        track(nf[:lam - 0.5sw, :lam + 0.5sw]);
        marker(:left :de.bf, nf[:lam] << 0.5mt);
        station(:right, nf[:lam] << 0.5mt << 1sh + (1dt, 0dt),
            hbox(:left:top, "Lamdrup"), "NRF: 5,0"
        );
    }

    with link = "line.dk.NRF" {
        track(nf[:lam + 0.5sw, :ref - 0.5sw]);
    }

    with link = "point.dk.Refsvindinge", railway = :station {
        track(nf[:ref - 0.5sw, :ref + 0.5sw]);
        marker(:right :de.bf, nf[:ref] >> 0.5mt);
        station(:left, nf[:ref] >> 0.5mt >> 1sh + (-1.2dt, 0.6dt),
            "Refsvindinge", "NRF: 10,0"
        );
    }

    with link = "line.dk.NRF" {
        track(nf[:ref + 0.5sw, :orb - 0.5sw]);
    }

    with link = "point.dk.Ørbæk", railway = :station {
        track(nf[:orb - 0.5sw, :orb + 0.5sw]);
        marker(:left :de.bf, nf[:orb] << 0.5mt);
        station(:right, nf[:orb] << 0.5mt << 1sh + (1.5dt, 1.8dt),
            "Ørbæk", "NRF: 12,6"
        );
    }

    with link = "line.dk.NRF" {
        track(nf[:orb + 0.5sw, :ell - 0.5sw]);
    }

    with link = "point.dk.Ellested", railway = :station {
        track(nf[:ell - 0.5sw, :ell + 0.5sw]);
        marker(:left :de.bf, nf[:ell] << 0.5mt);
        station(:right, nf[:ell] << 0.5mt << 1sh + (1.6dt, 2dt),
            "Ellested", "NRF: 16,6"
        );
    }

    with link = "line.dk.NRF" {
        track(nf[:ell + 0.5sw, :fje - 0.5sw]);
    }

    with link = "point.dk.Fjellerup", railway = :station {
        track(nf[:fje - 0.5sw, :fje + 0.5sw]);
        marker(:left :de.bf, nf[:fje] << 0.5mt);
        station(:bottom, nf[:fje] << 0.5mt << 1sh + (0.5dt, 0.8dt),
            "Fjellerup", "NRF: 20,2"
        );
    }

    with link = "line.dk.NRF" {
        track(nf[:fje + 0.5sw, :rys - 0.5sw]);
    }

    with link = "point.dk.Ryslinge", railway = :station {
        track(nf[:rys - 0.5sw, :rys + 0.5sw]);
        marker(:right :de.bf, nf[:rys] >> 0.5mt);
        station(:top, nf[:rys] >> 0.5mt >> 1sh + (0dt, -0.7dt),
            "Ryslinge", "NRF: 22,3"
        );
    }

    with link = "line.dk.NRF" {
        track(nf[:rys + 0.5sw, :rin.xn - 0.4km]);
        line_label(:right:s, nf[:rin.xn - 0.4km] >> 0.5mt, "NRF");
        track(nf[:rin.xn - 0.4km, :rin.xn - 1mo]);
        track(:lor,
                nf[:rin.xn - 1.01mo, :rin.xn - 1mo]
            ..  nf[:rin.yn, :rin.yn + 0.1dl] << 1mo
        );
    }

    # point.dk.Ringe  dk.OSB

    with link = "line.dk.NRF" {
        track(:lor, nf[:rin.yf, :rin.yf + 2seg]);
        track(nf[:rin.yf + 2seg, :rin.yf + 1km]);
        line_label(:right:se, nf[:rin.yf + 1km] >> 0.5mt, "NRF");
        track(nf[:rin.yf + 1km, :bol - 0.5sw]);
    }

    with link = "point.dk.Boltinggård", railway = :station {
        track(nf[:bol - 0.5sw, :bol + 0.5sw]);
        marker(:left :de.hp, nf[:bol] << 0.5mt);
        station(:left, nf[:bol] >> 0.5mt + (-1.8dt, 0.6dt),
            vbox(:center:base, span(:former, "Boltinge"), "Boltinggård"),
            "NRF: 29,5"
        );
    }

    with link = "line.dk.NRF" {
        track(nf[:bol + 0.5sw, :esp - 0.5sw]);
    }

    with link = "point.dk.Espe", railway = :station {
        track(nf[:esp - 0.5sw, :esp + 0.5sw]);
        marker(:left :de.bf, nf[:esp] << 0.5mt);
        station(:bottom, nf[:esp] << 0.5mt << 1sh + (0.5dt, 0.8dt),
            "Espe", "NRF: 33,0"
        );
    }

    with link = "line.dk.NRF" {
        track(nf[:esp + 0.5sw, :hoj - 0.5sw]);
    }

    with link = "point.dk.Højrup", railway = :station {
        track(nf[:hoj - 0.5sw, :hoj + 0.5sw]);
        marker(:right :de.bf, nf[:hoj] >> 0.5mt);
        station(:left, nf[:hoj] >> 0.5mt >> 1sh + (-1.8dt, 0.6dt),
            "Højrup", "NRF: 37,2"
        );
    }

    with link = "line.dk.NRF" {
        track(nf[:hoj + 0.5sw, :hag - 0.5sw]);
    }

    with link = "point.dk.Hågerup", railway = :station {
        track(nf[:hag - 0.5sw, :hag + 0.5sw]);
        marker(:left :de.hp, nf[:hag] << 0.5mt);
        station(:right, nf[:hag] << 0.5mt << 1sh + (1.3dt, 1.2dt),
            "Hågerup", "NRF: 40,0"
        );
    }

    with link = "line.dk.NRF" {
        track(nf[:hag + 0.5sw, :kor.a]);
    }
}

with detail = 4,
     railway = :first :museum
{

    with link = "point.dk.Korinth", railway = :station {
        track(nf[:kor.a, :kor + 0.5sw]);
        marker(:right :de.bf, nf[:kor] >> 0.5mt);
        station(:left, nf[:kor] >> 0.5mt >> 1sh + (-1.8dt, 1.8dt),
            "Korinth", "NRF: 43,3"
        );
    }

    with link = "line.dk.NRF" {
        track(nf[:kor + 0.5sw, :gro - 0.5sw]);
    }

    with link = "point.dk.Grønderup", railway = :station {
        track(nf[:gro - 0.5sw, :gro + 0.5sw]);
        marker(:left :de.hp, nf[:gro] << 0.5mt);
        station(:right, nf[:gro] << 0.5mt << 1sh + (1.3dt, 1.2dt),
            "Grønderup", "NRF: 46,7"
        );
    }

    with link = "line.dk.NRF" {
        track(nf[:gro + 0.5sw, :gro + 1.2km]);
        line_label(:right:e, nf[:gro + 1.2km] >> 0.5mt, "NRF");
        track(nf[:gro + 1.2km, :pej - 0.5sw]);
    }

    with link = "point.dk.Pejrup", railway = :station {
        track(nf[:pej - 0.5sw, :pej + 0.5sw]);
        marker(:left :de.bf, nf[:pej] << 0.5mt);
        station(:right, nf[:pej] << 0.5mt << 1sh + (1.3dt, 1.2dt),
            "Pejrup", "NRF: 49,0"
        );
    }

    with link = "line.dk.NRF" {
        track(nf[:pej + 0.5sw, :kat.ys - 1seg]);
        track(:lor, nf[:kat.ys - 1seg, :kat.ys]);
    }

    with link = "point.dk.Katterød", railway = :station {
        track(:removed :pax,
                nf[:kat.ys, :kat + 140m - 1dl] << 1mo
            --  nf[:kat + 140m, :kat + 141m]
        );
        track(nf[:kat.ys, :kat + 190m]);
        marker(:left :de.hp, nf[:kat] << 1mo << 0.5mt);
        marker(:left :de.exbf, nf[:kat] << 1mo << 0.5mt);
        station(:bottom, nf[:kat] << 1mo << 0.5mt << 1.4sh + (0dt, 0.7dt),
            span(:bold, "Katterød"),
            hbox(:center:top,
                vbox(:right:top, "NRF: ", span(:removed, "SBF: ")),
                vbox(:sep:top,
                    hbox(:sep:base, "51,", anchor(), "5"),
                    hbox(:sep:base :removed, "22,", anchor(), "1")
                )
            )
        );
    }

    with link = "line.dk.NRF" {
        track(nf[:kat + 190m, :luc - 0.5sw]);
    }

    with link = "point.dk.Lucienhøj", railway = :station {
        track(nf[:luc - 0.5sw, :luc + 0.5sw]);
        marker(:left :de.hp, nf[:luc] << 0.5mt);
        station(:bottom, nf[:luc] << 0.5mt << 1sh + (-0.5dt, 0.8dt),
            "Lucienhøj", "NRF: ??"
        );
    }

    with link = "line.dk.NRF" {
        track(nf[:luc + 0.5sw, :luc + 0.8km]);
        line_label(:right:sw, nf[:luc + 0.8km] >> 0.5mt, "NRF");
        track(nf[:luc + 0.8km, :faa - 0.5sw]);
    }

    with link = "point.dk.Faaborg", railway = :station {
        track(nf[:faa - 0.5sw, :faa + 0.5sw]);
        marker(:right :de.bf, nf[:faa] >> 0.5mt);
        station(:top, nf[:faa] >> 0.5mt >> 1sh + (0dt, -0.6dt),
            span(:bold, "Faaborg"),
            hbox(:center:top,
                vbox(:right:top, span(:removed, "ONF: "), "NRF: "),
                vbox(:sep:top,
                    hbox(:sep:base :removed, "47,", anchor(), "3"),
                    hbox(:sep:base, "55,", anchor(), "8")
                )
            )
        );
    }
}

