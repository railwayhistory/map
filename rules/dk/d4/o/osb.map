# DK OSB.  Odense - Svendborg
#
let os = path("d3.dk.osb");

with detail = 4,
     railway = :first :pax
{
    # point.dk.Odense  dk.KFA

    with link = "line.dk.OSB" {
        with layer = -1 track(:lor,
                os[:ode.yb, :ode.ys - 2dl] >> 1.5mo
            ..  os[:ode.ys + 269m, :ode.ys + 270m] >> 1.3mo
            ..  os[:ode.zs, :ode.zs + 0.1dl]
        );
        track(os[:ode.zs, :osy - 0.7km]);
        line_label(:right:ne, os[:osy - 0.7km] >> 0.5mt, "OSB");
        track(os[:osy - 0.7km, :osy - 0.5sw]);
    }

    with link  = "point.dk.Odense-Sygehus", railway = :station {
        track(os[:osy - 0.5sw, :osy.ys]);
        marker(:left :de.hp :casing, os[:osy] << 0.5mt);
        station(:right, os[:osy] << 0.5mt << 1sh + (1.5dt, 0.8dt),
            "O. Sygehus", "OSB: 3,813"
        );
    }

    with link = "line.dk.OSB" {
        track(os[:osy.ys, :osy.ys + 0.5km]);
        line_label(:right:e, os[:osy.ys + 0.5km] >> 0.5mt,
            (0dt, 0.3dt), "OSB"
        );
        track(os[:osy.ys + 0.5km, :fru - 570m]);
    }

    with link = "point.dk.Fruens-Bøge", railway = :station {
        # DK OSB
        track(os[:fru - 570m, :fru.yf]);

        # mot Faaborg
        track(
                os[:fru - 421m, :fru - 420m]
            --  os[:fru - 420m + 1dl, :fru + 120m - 1dl] >> 1mo
            --  os[:fru + 120m, :fru + 121m]
        );
        track(:removed, os[:fru + 120m - 1dl, :fru.yf] >> 1mo);

        marker(:left :de.bf, os[:fru] << 0.5mt);
        station(:right, os[:fru] << 0.5mt << 1sh + (1.8dt, 0.6dt),
            span(:bold, "Fruens Bøge"),
            hbox(:center:top,
                vbox(:right:top, span(:removed, "ONF: "), "OSB: "),
                vbox(:sep:top,
                    hbox(:sep:base :removed, "0,", anchor(), "0"),
                    hbox(:sep:base, "5,", anchor(), "300")
                )
            )
        );
    }

    with link = "line.dk.OSB" {
        track(:ror, os[:fru.yf, :fru.yf + 1.1seg]);
        track(os[:fru.yf + 1.1seg, :hja - 0.5sw]);
    }

    with link = "point.dk.Hjallese", railway = :station {
        track(os[:hja - 0.5sw, :hja.yt]);
        marker(:left :de.hp, os[:hja] << 0.5mt);
        station(:left, os[:hja] >> 0.5mt + (-1.5dt, 1.8dt),
            "Hjallese", "OSB: 6,896"
        );
    }

    with link = "line.dk.OSB" {
        track(os[:hja + 0.5sw, :lin - 0.5sw]);
    }

    with link = "point.dk.Lindved", railway = :station {
        track(os[:lin - 0.5sw, :lin + 0.5sw]);
        marker(:right :de.hp :removed, os[:lin] >> 0.5mt);
        station(:left :removed, os[:lin] >> 0.5mt >> 1sh + (-1.8dt, 1.8dt),
            "Lindved", "OSB: ??"
        );
    }

    with link = "line.dk.OSB" {
        track(os[:lin + 0.5sw, :hoj - 0.5sw]);
    }

    with link = "point.dk.Højby", railway = :station {
        track(os[:hoj - 0.5sw, :hoj + 0.5sw]);
        marker(:left :de.bf, os[:hoj] << 0.5mt);
        station(:right:left_align, os[:hoj] << 0.5mt << 1sh + (1.5dt, 1dt),
            "Højby", " OSB: 11,025"
        );
    }

    with link = "line.dk.OSB" {
        track(os[:hoj + 0.5sw, :ars - 0.5sw]);
    }

    with link = "point.dk.Årslev", railway = :station {
        track(os[:ars - 0.5sw, :ars + 0.5sw]);
        marker(:left :de.bf, os[:ars] << 0.5mt);
        station(:right:left_align, os[:ars] << 0.5mt << 1sh + (2.5dt, 0.5dt),
            "Årslev", "  OSB: 14,946"
        );
    }

    with link = "line.dk.OSB" {
        track(os[:ars + 0.5sw, :ped - 0.5sw]);
    }

    with link = "point.dk.Pederstrup", railway = :station {
        track(os[:ped - 0.5sw, :ped + 0.5sw]);
        marker(:left :de.hp, os[:ped] << 0.5mt);
        station(:right, os[:ped] << 0.5mt << 1sh + (1.3dt, 1.2dt),
            "Pederstrup", "OSB: 17,400"
        );
    }

    with link = "line.dk.OSB" {
        track(os[:ped + 0.5sw, :ped + 2.3km]);
        line_label(:right:e, os[:ped + 2.3km] >> 0.5mt, "OSB");
        track(os[:ped + 2.3km, :rin.yn - 100m]);
    }

    with link = "point.dk.Ringe", railway = :station {
        track(:removed, os[:rin.yn, :rin - 140m + 1dl] << 1mo);
        track(
                os[:rin - 141m, :rin - 140m]
            --  os[:rin - 140m + 1dl, :rin + 560m] << 1mo
        );

        track(
                os[:rin.yn - 100m, :rin + 560m - 1dl]
            --  os[:rin + 560m, :rin.yf] << 1mo
        );
        track(:removed, os[:rin + 560m - 1dl, :rin.yf]);

        marker(:right :de.bf, os[:rin] >> 0.5mt);
        station(:left:right_align, os[:rin] >> 0.5mt >> 1sh + (-1.5dt, 1.2dt),
            span(:bold, "Ringe"),
            hbox(:center:top,
                vbox(:right:top, "OSB: ", span(:removed, "NRF: ")),
                vbox(:sep:top,
                    hbox(:sep:base, "22,", anchor(), "368"),
                    hbox(:sep:base :removed, "26,", anchor(), "4")
                )
            )
        );
    }

    with link = "line.dk.OSB" {
        track(:ror,
                os[:rin.yf - 0.1dl, :rin.yf] << 1mo
            ..  os[:rin.xf, :rin.xf + 0.1dl]
        );
        track(os[:rin.xf, :rin.xf + 1km]);
        line_label(:left:w, os[:rin.xf + 1km] << 0.5mt, "OSB");
        track(os[:rin.xf + 1km, :rud - 0.5sw]);
    }

    with link = "point.dk.Rudme", railway = :station {
        track(os[:rud - 0.5sw, :rud + 0.5sw]);
        marker(:right :de.hp, os[:rud] >> 0.5mt);
        station(:left:right_align, os[:rud] >> 0.5mt >> 1sh + (-1.3dt, 1.8dt),
            "Rudme", "OSB: 27,194 "
        );
    }

    with link = "line.dk.OSB" {
        track(os[:rud + 0.5sw, :kva - 0.5sw]);
    }

    with link = "point.dk.Kværndrup", railway = :station {
        track(os[:kva - 0.5sw, :kva + 0.5sw]);
        marker(:left :de.bf, os[:kva] << 0.5mt);
        station(:right, os[:kva] << 0.5mt << 1sh + (1.8dt, 0.6dt),
            "Kværndrup", "OSB: 30,188"
        );
    }

    with link = "line.dk.OSB" {
        track(os[:kva + 0.5sw, :ste - 0.5sw]);
    }

    with link = "point.dk.Stenstrup", railway = :station {
        track(os[:ste - 0.5sw, :ste + 0.5sw]);
        marker(:right :de.bf, os[:ste] >> 0.5mt);
        station(:left, os[:ste] >> 0.5mt >> 1sh + (-1.5dt, 1.5dt),
            "Stenstrup", "OSB: 35,598"
        );
    }

    with link = "line.dk.OSB" {
        track(os[:ste + 0.5sw, :sts - 0.5sw]);
    }

    with link = "point.dk.Stenstrup-Syd", railway = :station {
        track(os[:sts - 0.5sw, :sts + 0.5sw]);
        marker(:left :de.hp, os[:sts] << 0.5mt);
        label(os[:sts] << 0.5mt << 1sh + (1.5dt, 1.0dt),
            vbox(:left:base,
                span(:former, "Stenstrup Sidespor"),
                vbox(:center:topbase,
                    "Stenstrup Syd",
                    span(:xsmall, "OSB: 36,952")
                )
            )
        );
    }

    with link = "line.dk.OSB" {
        track(os[:sts + 0.5sw, :kir - 0.5sw]);
    }

    with link = "point.dk.Kirkeby", railway = :station {
        track(os[:kir - 0.5sw, :kir + 0.5sw]);
        marker(:left :de.hp :removed, os[:kir] << 0.5mt);
        marker(:left :de.exbf :removed, os[:kir] << 0.5mt);
        station(:right :removed, os[:kir] << 0.5mt << 1.5sh + (1.2dt, 0.6dt),
            "Kirkeby", "OSB: ??"
        );
    }

    with link = "line.dk.OSB" {
        track(os[:kir + 0.5sw, :sor - 0.5sw]);
    }

    with link = "point.dk.Sørup", railway = :station {
        track(os[:sor - 0.5sw, :sor + 0.5sw]);
        marker(:right :de.bf :removed, os[:sor] >> 0.5mt);
        station(:left :removed, os[:sor] >> 0.5mt >> 1sh + (-1.5dt, 1.8dt),
            "Sørup", "OSB: ??"
        );
    }

    with link = "line.dk.OSB" {
        track(os[:sor + 0.5sw, :svv - 0.5sw]);
    }

    with link = "point.dk.Svendborg-Vest", railway = :station {
        track(os[:svv - 0.5sw, :svv + 0.5sw]);
        marker(:right :de.hp, os[:svv] >> 0.5mt);
        station(:left, os[:svv] >> 0.5mt >> 1sh + (-1.3dt, 1.3dt),
            "Svendborg Vest", "OSB: 45,695"
        );
    }

    with link = "line.dk.OSB" {
        track(os[:svv + 0.5sw, :sve.yf - 1.1seg]);
        track(:ror, os[:sve.yf - 1.1seg, :sve.yf]);
        track(:ror, os[:sve.yf, :sve.yf + 0.75km]);
        line_label(:left:se, os[:sve.yf + 0.75km] << 0.5mt, "OSB");
        track(:ror, os[:sve.yf + 0.75km, :sve - 0.5sw]);
    }

    with link = "point.dk.Svendborg", railway = :station {
        track(os[:sve - 0.5sw, :sve + 160m]);
        track(:removed, os[:sve - 0.5sw, :sve + 160m] >> 1mo);

        marker(:left :de.bf, os[:sve] << 0.5mt);
        station(:right, os[:sve] >> 1mo >> 0.5mt + (1.1dt, 1.2dt),
            span(:bold, "Svendborg"),
            hbox(:center:top,
                vbox(:right:top,
                    "OSB: ",
                    span(:removed, "SBF: "),
                    span(:removed, "SNB: ")
                ),
                vbox(:sep:top,
                    hbox(:sep:base, "48,", anchor(), "220"),
                    hbox(:sep:base :removed, "0,", anchor(), "0"),
                    hbox(:sep:base :removed, "0,", anchor(), "0")
                )
            )
        );
    }
}

