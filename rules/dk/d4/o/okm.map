# DK OKM.  Odense - Kertminde - Martofte
#
let om = path("d3.dk.okm");

with detail = 4,
     railway = :first :pax :removed
{
    # point.dk.Odense  dk.KFA

    with link = "line.dk.OKM" {
        track(:ror, om[:ode.ym - 60m, :ode.xm] << 1.5mo);
        track(
                om[:ode.xm - 0.1dl, :ode.xm] << 1.5mo
            ..  om[:ode.zm + 2.5mo, :bis - 0.5sw]
        );
    }

    with link = "point.dk.Biskorup", railway = :station {
        track(om[:bis - 0.5sw, :bis + 0.5sw]);
        marker(:right :de.hp, om[:bis] >> 0.5mt);
        station(:right, om[:bis] >> 0.5mt >> 1sh + (1.8dt, 2dt),
            "Biskorup", "OKM: 4,0"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:bis + 0.5sw, :sed - 0.5sw]);
    }

    with link = "point.dk.Seden", railway = :station {
        track(om[:sed - 0.5sw, :sed + 0.5sw]);
        marker(:left :de.bf, om[:sed] << 0.5mt);
        station(:top, om[:sed] << 0.5mt << 1sh + (-0.5dt, -1dt),
            "Seden", "OKM: 4,8"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:sed + 0.5sw, :sed + 0.85km]);
        line_label(:right:n, om[:sed + 0.85km] >> 0.5mt, "OKM");
        track(om[:sed + 0.85km, :bul - 0.5sw]);
    }

    with link = "point.dk.Bullerup", railway = :station {
        track(om[:bul - 0.5sw, :bul + 0.5sw]);
        marker(:left :de.hst, om[:bul] << 0.5mt);
        station(:top, om[:bul] << 0.5mt << 1sh + (-0.5dt, -0.8dt),
            "Bullerup", "OKM: 6,5"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:bul + 0.5sw, :age - 0.5sw]);
    }

    with link = "point.dk.Agedrup", railway = :station {
        track(om[:age - 0.5sw, :age + 0.5sw]);
        marker(:left :de.bf, om[:age] << 0.5mt);
        station(:top, om[:age] << 0.5mt << 1sh + (-0.7dt, -1dt),
            "Agedrup", "OKM: 7,8"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:age + 0.5sw, :vka - 0.5sw]);
    }

    with link = "point.dk.Vester-Kærby", railway = :station {
        track(om[:vka - 0.5sw, :vka + 0.5sw]);
        marker(:right :de.hp, om[:vka] >> 0.5mt);
        station(:right, om[:vka] >> 0.5mt >> 1sh + (2dt, 1.8dt),
            "Vester Kærby", "OKM: 9,2"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:vka + 0.5sw, :dra - 0.5sw]);
    }

    with link = "point.dk.Dræby", railway = :station {
        track(om[:dra - 0.5sw, :dra + 0.5sw]);
        marker(:left :de.bf, om[:dra] << 0.5mt);
        station(:top, om[:dra] << 0.5mt << 1sh + (0.3dt, -0.8dt),
            "Dræby", "OKM: 10,0"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:dra + 0.5sw, :tre - 0.5sw]);
    }

    with link = "point.dk.Trellerup", railway = :station {
        track(om[:tre - 0.5sw, :tre + 0.5sw]);
        marker(:right :de.hp, om[:tre] >> 0.5mt);
        station(:left, om[:tre] >> 0.5mt >> 1sh + (-1.5dt, 2dt),
            "Trellerup", "OKM: 11,7"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:tre + 0.5sw, :kol - 0.5sw]);
    }

    with link = "point.dk.Kølstrup", railway = :station {
        track(om[:kol - 0.5sw, :kol + 0.5sw]);
        marker(:left :de.bf, om[:kol] << 0.5mt);
        station(:top, om[:kol] << 0.5mt << 1sh + (0.5dt, -0.8dt),
            "Kølstrup", "OKM: 14,3"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:kol + 0.5sw, :lad - 0.5sw]);
    }

    with link = "point.dk.Ladby", railway = :station {
        track(om[:lad - 0.5sw, :lad + 0.5sw]);
        marker(:left :de.bf, om[:lad] << 0.5mt);
        station(:right :left_align, om[:lad] << 0.5mt << 1sh + (2dt, 0dt),
            "Ladby", " OKM: 17,0"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:lad + 0.5sw, :ryn - 0.5sw]);
    }

    with link = "point.dk.Rynkeby", railway = :station {
        track(om[:ryn - 0.5sw, :ryn + 0.5sw]);
        marker(:right :de.hp, om[:ryn] >> 0.5mt);
        station(:bottom, om[:ryn] >> 0.5mt >> 1sh + (-0.5dt, 1dt),
            "Rynkeby", "OKM: 18,4"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:ryn + 0.5sw, :rev - 0.5sw]);
    }

    with link = "point.dk.Revninge", railway = :station {
        track(om[:rev - 0.5sw, :rev + 0.5sw]);
        marker(:left :de.bf, om[:rev] << 0.5mt);
        station(:right, om[:rev] >> 0.5mt + (1.3dt, 1.2dt),
            "Revninge", "OKM: 20,3"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:rev + 0.5sw, :rev + 1.5km]);
        line_label(:right:w, om[:rev + 1.5km] >> 0.5mt, "OKM");
        track(om[:rev + 1.5km, :ker - 0.5sw]);
    }

    with link = "point.dk.Kerteminde", railway = :station {
        track(om[:ker - 0.5sw, :ker + 0.5sw]);
        marker(:left :de.bf, om[:ker] << 0.5mt);
        station(:left, om[:ker] << 0.5mt << 1sh + (-1.3dt, 1dt),
            "Kerteminde", "OKM: 23,9"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:ker + 0.5sw, :tar - 0.5sw]);
    }

    with link = "point.dk.Tårup", railway = :station {
        track(om[:tar - 0.5sw, :tar + 0.5sw]);
        marker(:left :de.hp, om[:tar] << 0.5mt);
        station(:left:right_align, om[:tar] << 0.5mt << 1sh + (-1.3dt, 1.2dt),
            "Tårup", "OKM: 27,4"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:tar + 0.5sw, :mes - 0.5sw]);
    }

    with link = "point.dk.Mesinge", railway = :station {
        track(om[:mes - 0.5sw, :mes + 0.5sw]);
        marker(:right :de.bf, om[:mes] >> 0.5mt);
        station(:right, om[:mes] >> 0.5mt >> 1sh + (1.8dt, 1dt),
            "Mesinge", "OKM: 29,3"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:mes + 0.5sw, :mes + 1.2km]);
        line_label(:left:e, om[:mes + 1.2km] << 0.5mt, "OKM");
        track(om[:mes + 1.2km, :dal - 0.5sw]);
    }

    with link = "point.dk.Dalby", railway = :station {
        track(om[:dal - 0.5sw, :dal + 0.5sw]);
        marker(:left :de.bf, om[:dal] << 0.5mt);
        station(:left:right_align, om[:dal] << 0.5mt << 1sh + (-1.5dt, 0.9dt),
            "Dalby", "OKM: 31,8 "
        );
    }

    with link = "line.dk.OKM" {
        track(om[:dal + 0.5sw, :her - 0.5sw]);
    }

    with link = "point.dk.Hersnap", railway = :station {
        track(om[:her - 0.5sw, :her + 0.5sw]);
        marker(:right :de.hp, om[:her] >> 0.5mt);
        station(:right, om[:her] >> 0.5mt >> 1sh + (1.3dt, 1.3dt),
            "Hersnap", "OKM: 33,0"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:her + 0.5sw, :kir - 0.5sw]);
    }

    with link = "point.dk.Kirkebro", railway = :station {
        track(om[:kir - 0.5sw, :kir + 0.5sw]);
        marker(:right :de.hp, om[:kir] >> 0.5mt);
        station(:right, om[:kir] >> 0.5mt >> 1sh + (1.3dt, 1.1dt),
            "Kirkebro", "OKM: 34,0"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:kir + 0.5sw, :mar - 0.5sw]);
    }

    with link = "point.dk.Martofte", railway = :station {
        track(om[:mar - 0.5sw, :mar.f]);
        marker(:left :de.bf, om[:mar] << 0.5mt);
        station(:left, om[:mar] << 0.5mt << 1sh + (-1.5dt, 1.6dt),
            span(:bold, "Martofte"), "OKM: 35,6"
        );
    }
}

