# DK OMF.  Odense - Middelfart
#
let om = path("d3.dk.omf");

with detail = 3,
     railway = :first :pax :removed
{
    # point.dk.Odense  dk.KFA

    with link = "line.dk.OMF" {
        track(:ror:lor,
                om[:ode.yb - 1.1mt, :ode.yb - 1mt] >> 0.5md >> 2ms >> 1.5mt
            ..  om[:ode.xm, :ode.xm + 0.1dl]
        );
        track(om[:ode.xm, :sne - 0.49sw]);
    }

    with link = "point.dk.Snestrup", railway = :station {
        track(om[:sne - 0.5sw, :sne + 0.5sw]);
        marker(:left :de.hp, om[:sne] << 0.5mt);
        slabel(:bottom, om[:sne] << 0.5mt << 1sh + (-3dt, 0.2dt), "Snestrup");
    }

    with link = "line.dk.OMF" {
        track(om[:sne + 0.49sw, :vil - 0.49sw]);
    }

    with link = "point.dk.Villestofte", railway = :station {
        track(om[:vil - 0.5sw, :vil + 0.5sw]);
        marker(:right :de.bf, om[:vil] >> 0.5mt);
        slabel(:top, om[:vil] >> 0.5mt >> 1sh + (1dt, -0.5dt), "Villestofte");
    }

    with link = "line.dk.OMF" {
        track(om[:vil + 0.49sw, :vil + 0.9km]);
        line_label(:left:n, om[:vil + 0.9km] << 0.5mt, "OMF");
        track(om[:vil + 0.9km, :kor - 0.49sw]);
    }

    with link = "point.dk.Korup", railway = :station {
        track(om[:kor - 0.5sw, :kor + 0.5sw]);
        marker(:right :de.bf, om[:kor] >> 0.5mt);
        slabel(:top, om[:kor] >> 0.5mt >> 1sh + (0.5dt, -0.3dt), "Korup");
    }

    with link = "line.dk.OMF" {
        track(om[:kor + 0.49sw, :slu - 0.49sw]);
    }

    with link = "point.dk.Slukefter", railway = :station {
        track(om[:slu - 0.5sw, :slu + 0.5sw]);
        marker(:right :de.hp, om[:slu] >> 0.5mt);
        slabel(:ne, om[:slu] << 0.5mt + (-1dt, -0.8dt), "Slukefter");
    }

    with link = "line.dk.OMF" {
        track(om[:slu + 0.49sw, :brb - 0.49sw]);
    }

    with link = "point.dk.Bredbjerg", railway = :station {
        track(om[:brb - 0.5sw, :brb + 0.5sw]);
        marker(:right :de.hp, om[:brb] >> 0.5mt);
        slabel(:right, om[:brb] >> 0.5mt >> 1sh + (1.3dt, 0.3dt),
            "Bredbjerg"
        );
    }

    with link = "line.dk.OMF" {
        track(om[:brb + 0.49sw, :lan - 0.49sw]);
    }

    with link = "point.dk.Langesø", railway = :station {
        track(om[:lan - 0.5sw, :lan + 0.5sw]);
        marker(:right :de.bf, om[:lan] >> 0.5mt);
        slabel(:right, om[:lan] >> 0.5mt >> 1sh + (-2.5dt, -1dt), "Langesø");
    }

    with link = "line.dk.OMF" {
        track(om[:lan + 0.49sw, :mor - 0.49sw]);
    }

    with link = "point.dk.Morud", railway = :station {
        track(om[:mor - 0.5sw, :mor + 0.5sw]);
        marker(:left :de.bf, om[:mor] << 0.5mt);
        slabel(:left, om[:mor] << 0.5mt << 1sh + (-1.3dt, 1.1dt), "Morud");
    }

    with link = "line.dk.OMF" {
        track(om[:mor + 0.49sw, :far - 0.49sw]);
    }

    with link = "point.dk.Farstrup", railway = :station {
        track(om[:far - 0.5sw, :far + 0.5sw]);
        marker(:right :de.bf, om[:far] >> 0.5mt);
        slabel(:right, om[:far] >> 0.5mt >> 1sh + (1.3dt, -0.3dt),
            "Farstrup"
        );
    }

    with link = "line.dk.OMF" {
        track(om[:far + 0.49sw, :vef - 0.49sw]);
    }

    with link = "point.dk.Veflinge", railway = :station {
        track(om[:vef - 0.5sw, :vef + 0.5sw]);
        marker(:right :de.bf, om[:vef] >> 0.5mt);
        slabel(:right, om[:vef] >> 0.5mt >> 1sh + (-2.3dt, -1dt),
            "Veflinge"
        );
    }

    with link = "line.dk.OMF" {
        track(om[:vef + 0.49sw, :vef + 1.8km]);
        line_label(:left:n, om[:vef + 1.8km] << 0.5mt, "OMF");
        track(om[:vef + 1.8km, :gam - 0.49sw]);
    }

    with link = "point.dk.Gamby", railway = :station {
        track(om[:gam - 0.5sw, :gam + 0.5sw]);
        marker(:right :de.bf, om[:gam] >> 0.5mt);
        slabel(:top, om[:gam] >> 0.5mt >> 1sh + (0.5dt, -0.3dt),
            "Gamby"
        );
    }

    with link = "line.dk.OMF" {
        track(om[:gam + 0.49sw, :nym - 0.49sw]);
    }

    with link = "point.dk.Nymark", railway = :station {
        track(om[:nym - 0.5sw, :nym + 0.5sw]);
        marker(:left :de.bf, om[:nym] << 0.5mt);
        slabel(:bottom, om[:nym] << 0.5mt << 1sh + (1dt, 0.2dt),
            "Nymark"
        );
    }

    with link = "line.dk.OMF" {
        track(om[:nym + 0.49sw, :har - 0.49sw]);
    }

    with link = "point.dk.Harndrup", railway = :station {
        track(om[:har - 0.5sw, :har + 0.5sw]);
        marker(:left :de.bf, om[:har] << 0.5mt);
        slabel(:bottom, om[:har] << 0.5mt << 1sh + (-0.5dt, 0.2dt),
            "Harndrup"
        );
    }

    with link = "line.dk.OMF" {
        track(om[:har + 0.49sw, :har + 2.2km]);
        line_label(:left:ne, om[:har + 2.2km] << 0.5mt, "OMF");
        track(om[:har + 2.2km, :bre.yb - 0.5seg]);
        track(:ror, om[:bre.yb - 0.5seg, :bre.yb]);
    }

    with link = "point.dk.Brenderup", railway = :station {
        track(om[:bre.yb, :bre + 0.5sw + 2dl]);
        track(
                om[:bre.yb, :bre + 0.5sw] >> 1ms >> 1mt
            --  om[:bre + 0.5sw + 1dl, :bre + 0.5sw + 1.1dl]
        );
        marker(:right :de.bf, om[:bre] >> 1ms >> 1.5mt);
        slabel(:top :bold, om[:bre] >> 1ms >> 1.5mt >> 1sh + (-1dt, -0.3dt),
            "Brenderup"
        );
    }

    with link = "line.dk.OMF" {
        track(om[:bre + 0.49sw + 2dl, :bre + 1.6km]);
        line_label(:right:se, om[:bre + 1.6km] >> 0.5mt, "OMF");
        track(om[:bre + 1.6km, :asp - 0.49sw]);
    }

    with link = "point.dk.Asperup", railway = :station {
        track(om[:asp - 0.5sw, :asp + 0.5sw]);
        marker(:right :de.bf, om[:asp] >> 0.5mt);
        slabel(:top, om[:asp] >> 0.5mt >> 1sh + (0dt, -0.3dt),
            "Asperup"
        );
    }

    with link = "line.dk.OMF" {
        track(om[:asp + 0.49sw, :bla - 0.49sw]);
    }

    with link = "point.dk.Blanke", railway = :station {
        track(om[:bla - 0.5sw, :bla + 0.5sw]);
        marker(:right :de.hp, om[:bla] >> 0.5mt);
        marker(:right :de.exbf, om[:bla] >> 0.5mt);
        slabel(:top, om[:bla] >> 0.5mt >> 1.5sh + (1dt, -0.3dt),
            "Blanke"
        );
    }

    with link = "line.dk.OMF" {
        track(om[:bla + 0.49sw, :kus - 0.49sw]);
    }

    with link = "point.dk.Kustrup", railway = :station {
        track(om[:kus - 0.5sw, :kus + 0.5sw]);
        marker(:right :de.hp, om[:kus] >> 0.5mt);
        marker(:right :de.exbf, om[:kus] >> 0.5mt);
        slabel(:right, om[:kus] >> 0.5mt >> 1.5sh + (1dt, 0dt),
            "Kustrup"
        );
    }

    with link = "line.dk.OMF" {
        track(om[:kus + 0.49sw, :roj - 0.49sw]);
    }

    with link = "point.dk.Røjle", railway = :station {
        track(om[:roj - 0.5sw, :roj + 0.5sw]);
        marker(:right :de.bf, om[:roj] >> 0.5mt);
        slabel(:top, om[:roj] >> 0.5mt >> 1sh + (0.5dt, -0.5dt),
            "Røjle"
        );
    }

    with link = "line.dk.OMF" {
        track(om[:roj + 0.49sw, :roj + 1.3km]);
        line_label(:right:s, om[:roj + 1.3km] >> 0.5mt, "OMF");
        track(om[:roj + 1.3km, :sta - 0.49sw]);
    }

    with link = "point.dk.Staurby-Skov", railway = :station {
        track(om[:sta - 0.5sw, :sta + 0.5sw]);
        marker(:left :de.hp, om[:sta] << 0.5mt);
        slabel(:right, om[:sta] << 0.5mt << 1sh + (1dt, 1.5dt),
            vbox(:left:topbase, "Staurby", "  Skov")
        );
    }

    with link = "line.dk.OMF" {
        track(:ror,
                om[:sta + 0.49sw, :sta + 0.5sw]
            ..  om[:mig.yo, :mig.yo + 0.1dl]
        );
    }

    # point.dk.Middelfart-gamle

    with link = "line.dk.OMF" {
        track(:ror:lor,
                om[:mig.ym - 1.1md, :mig.ym - 1md]
            ..  om[:mid.yb, :mid.yb + 0.1dl] >> 0.5md >> 1ms >> 0.5mt
        );
    }
}

