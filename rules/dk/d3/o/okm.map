# DK OKM.  Odense - Kertminde - Martofte
#
let om = path("d3.dk.okm");

with detail = 3,
     railway = :first :pax :removed
{
    # point.dk.Odense  dk.KFA

    with link = "line.dk.OKM" {
        track(:ror,
                om[:ode.ym, :ode.xm] << 0.5md << 1ms << 0.5mt
            ..  om[:ode.zm + 3md, :ode.zm + 3.1md]
        );
        track(om[:ode.zm + 3md, :bis - 0.5sw]);
    }

    with link = "point.dk.Biskorup", railway = :station {
        track(om[:bis - 0.5sw, :bis + 0.5sw]);
        marker(:right :de.hp, om[:bis] >> 0.5mt);
        slabel(:left, om[:bis] << 0.5mt + (-1.3dt, 0.5dt), "Biskorup");
    }

    with link = "line.dk.OKM" {
        track(om[:bis + 0.5sw, :sed - 0.5sw]);
    }

    with link = "point.dk.Seden", railway = :station {
        track(om[:sed - 0.5sw, :sed + 0.5sw]);
        marker(:left :de.bf, om[:sed] << 0.5mt);
        slabel(:left, om[:sed] << 0.5mt << 1sh + (2dt, -1dt), "Seden");
    }

    with link = "line.dk.OKM" {
        track(om[:sed + 0.5sw, :sed + 0.85km]);
        line_label(:right:n, om[:sed + 0.85km] >> 0.5mt, "OKM");
        track(om[:sed + 0.85km, :bul - 0.5sw]);
    }

    with link = "point.dk.Bullerup", railway = :station {
        track(om[:bul - 0.5sw, :bul + 0.5sw]);
        marker(:left :de.hst, om[:bul] << 0.5mt);
        slabel(:left, om[:bul] << 0.5mt << 1sh + (3dt, -1dt), "Bullerup");
    }

    with link = "line.dk.OKM" {
        track(om[:bul + 0.5sw, :age - 0.5sw]);
    }

    with link = "point.dk.Agedrup", railway = :station {
        track(om[:age - 0.5sw, :age + 0.5sw]);
        marker(:left :de.bf, om[:age] << 0.5mt);
        slabel(:left, om[:age] << 0.5mt << 1sh + (3dt, -1.5dt), "Agedrup");
    }

    with link = "line.dk.OKM" {
        track(om[:age + 0.5sw, :vka - 0.5sw]);
    }

    with link = "point.dk.Vester-Kærby", railway = :station {
        track(om[:vka - 0.5sw, :vka + 0.5sw]);
        marker(:right :de.hp, om[:vka] >> 0.5mt);
        slabel(:bottom, om[:vka] >> 0.5mt >> 1sh + (1dt, 0.5dt),
            vbox(:center:top, "Vester", "Kærby")
        );
    }

    with link = "line.dk.OKM" {
        track(om[:vka + 0.5sw, :dra - 0.5sw]);
    }

    with link = "point.dk.Dræby", railway = :station {
        track(om[:dra - 0.5sw, :dra + 0.5sw]);
        marker(:left :de.bf, om[:dra] << 0.5mt);
        slabel(:top, om[:dra] << 0.5mt << 1sh + (0.3dt, -0.3dt), "Dræby");
    }

    with link = "line.dk.OKM" {
        track(om[:dra + 0.5sw, :tre - 0.5sw]);
    }

    with link = "point.dk.Trellerup", railway = :station {
        track(om[:tre - 0.5sw, :tre + 0.5sw]);
        marker(:right :de.hp, om[:tre] >> 0.5mt);
        slabel(:right, om[:tre] << 0.5mt + (1dt, 0.3dt), "Trellerup");
    }

    with link = "line.dk.OKM" {
        track(om[:tre + 0.5sw, :kol - 0.5sw]);
    }

    with link = "point.dk.Kølstrup", railway = :station {
        track(om[:kol - 0.5sw, :kol + 0.5sw]);
        marker(:left :de.bf, om[:kol] << 0.5mt);
        slabel(:top, om[:kol] << 0.5mt << 1sh + (1dt, -0.3dt), "Kølstrup");
    }

    with link = "line.dk.OKM" {
        track(om[:kol + 0.5sw, :lad - 0.5sw]);
    }

    with link = "point.dk.Ladby", railway = :station {
        track(om[:lad - 0.5sw, :lad + 0.5sw]);
        marker(:left :de.bf, om[:lad] << 0.5mt);
        slabel(:top, om[:lad] << 0.5mt << 1sh + (1.5dt, -0.8dt), "Ladby");
    }

    with link = "line.dk.OKM" {
        track(om[:lad + 0.5sw, :ryn - 0.5sw]);
    }

    with link = "point.dk.Rynkeby", railway = :station {
        track(om[:ryn - 0.5sw, :ryn + 0.5sw]);
        marker(:right :de.hp, om[:ryn] >> 0.5mt);
        slabel(:bottom, om[:ryn] >> 0.5mt >> 1sh + (0dt, 0.5dt), "Rynkeby");
    }

    with link = "line.dk.OKM" {
        track(om[:ryn + 0.5sw, :rev - 0.5sw]);
    }

    with link = "point.dk.Revninge", railway = :station {
        track(om[:rev - 0.5sw, :rev + 0.5sw]);
        marker(:left :de.bf, om[:rev] << 0.5mt);
        slabel(:right, om[:rev] >> 0.5mt + (1dt, 1.2dt), "Revninge");
    }

    with link = "line.dk.OKM" {
        track(om[:rev + 0.5sw, :rev + 1.5km]);
        line_label(:right:w, om[:rev + 1.5km] >> 0.5mt, "OKM");
        track(om[:rev + 1.5km, :ker - 0.5sw]);
    }

    with link = "point.dk.Kerteminde", railway = :station {
        track(om[:ker - 0.5sw, :ker + 0.5sw]);
        marker(:left :de.bf, om[:ker] << 0.5mt);
        slabel(:left, om[:ker] << 0.5mt << 1sh + (-1.3dt, 0.8dt),
            "Kerteminde"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:ker + 0.5sw, :tar - 0.5sw]);
    }

    with link = "point.dk.Tårup", railway = :station {
        track(om[:tar - 0.5sw, :tar + 0.5sw]);
        marker(:left :de.hp, om[:tar] << 0.5mt);
        slabel(:left, om[:tar] << 0.5mt << 1sh + (-1.1dt, 1dt),
            "Tårup"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:tar + 0.5sw, :mes - 0.5sw]);
    }

    with link = "point.dk.Mesinge", railway = :station {
        track(om[:mes - 0.5sw, :mes + 0.5sw]);
        marker(:right :de.bf, om[:mes] >> 0.5mt);
        slabel(:right, om[:mes] >> 0.5mt >> 1sh + (1.2dt, 0.9dt), "Mesinge");
    }

    with link = "line.dk.OKM" {
        track(om[:mes + 0.5sw, :mes + 1.2km]);
        line_label(:left:e, om[:mes + 1.2km] << 0.5mt, "OKM");
        track(om[:mes + 1.2km, :dal - 0.5sw]);
    }

    with link = "point.dk.Dalby", railway = :station {
        track(om[:dal - 0.5sw, :dal + 0.5sw]);
        marker(:left :de.bf, om[:dal] << 0.5mt);
        slabel(:left, om[:dal] << 0.5mt << 1sh + (-1.3dt, 0.9dt),
            "Dalby"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:dal + 0.5sw, :her - 0.5sw]);
    }

    with link = "point.dk.Hersnap", railway = :station {
        track(om[:her - 0.5sw, :her + 0.5sw]);
        marker(:right :de.hp, om[:her] >> 0.5mt);
        slabel(:right, om[:her] >> 0.5mt >> 1sh + (1.1dt, 1.2dt),
            "Hersnap"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:her + 0.5sw, :kir - 0.5sw]);
    }

    with link = "point.dk.Kirkebro", railway = :station {
        track(om[:kir - 0.5sw, :kir + 0.5sw]);
        marker(:right :de.hp, om[:kir] >> 0.5mt);
        slabel(:right, om[:kir] >> 0.5mt >> 1sh + (1dt, 1dt),
            "Kirkebro"
        );
    }

    with link = "line.dk.OKM" {
        track(om[:kir + 0.5sw, :mar - 0.5sw]);
    }

    with link = "point.dk.Martofte", railway = :station {
        track(om[:mar - 0.5sw, :mar.f]);
        marker(:left :de.bf, om[:mar] << 0.5mt);
        slabel(:left :bold, om[:mar] << 0.5mt << 1sh + (-1.3dt, 1.3dt),
            "Martofte"
        );
    }
}

