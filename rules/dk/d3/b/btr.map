# DK BTR.  Bramming - Tønder Grænse
#
let bt = path("d3.dk.btr");

with detail = 3,
     railway = :first :pax
{
    # point.dk.Bramming                           dk.LE

    with link = "line.dk.BTR" {
        track(
                bt[:bra.yt - 0.1dl, :bra.yt] >> 0.5md >> 1ms >> 0.5mt
            ..  bt[:bra.xt + 1md, :sej - 1.5km]
        );
        line_label(:left:w, bt[:sej - 1.5km] << 0.5mt, "BTR");
        track(bt[:sej - 1.5km, :sej - 0.5sw]);
    }

    with link = "point.dk.Sejstrup", railway = :station {
        track(bt[:sej - 0.5sw, :sej + 0.5sw]);
        marker(:left :de.hp, bt[:sej] << 0.5mt);
        slabel(:right, bt[:sej + 0.5sw] << 0.5mt << 1.4sh, "Sejstrup");
    }

    with link = "line.dk.BTR" {
        track(bt[:sej + 0.5sw, :gre - 0.5sw]);
    }

    with link = "point.dk.Gredstedbro", railway = :station {
        track(bt[:gre - 0.5sw, :gre + 0.5sw]);
        marker(:left :de.bf, bt[:gre] << 0.5mt);
        slabel(:right, bt[:gre + 0.5sw] << 0.5mt << 1.4sh, "Gredstedbro");
    }

    with link = "line.dk.BTR" {
        track(bt[:gre + 0.5sw, :rin - 0.5sw]);
    }

    with link = "point.dk.Ribe-Nørremark", railway = :station {
        track(bt[:rin - 0.5sw, :rin + 0.5sw]);
        marker(:left :de.hp, bt[:rin] << 0.5mt);
        slabel(:right, bt[:rin] << 0.5mt << 1.4sh + (0dt, 0.5sw),
            "Ribe Nørremark"
        );
    }

    with link = "line.dk.BTR" {
        track(bt[:rin + 0.5sw, :rib - 0.5sw]);
    }

    with link = "point.dk.Ribe", railway = :station {
        track(bt[:rib - 0.5sw, :rib + 0.5sw]);
        marker(:right :de.bf, bt[:rib] >> 0.5mt);
        slabel(:left, bt[:rib + 0.5sw] >> 0.5mt >> 1.4sh, "Ribe");
    }

    with link = "line.dk.BTR" {
        track(bt[:rib + 0.5sw, :rib + 2.5km]);
        line_label(:left:w, bt[:rib + 2.5km] << 0.5mt, (0dt, 0.1dt), "BTR");
        track(bt[:rib + 2.5km, :rig - 1.2sw]);
    }

    with link = "point.dk.Vedsted", railway = :station {
        track(bt[:rig - 1.2sw, :rig - 0.2sw]);
        marker(:right :de.bf :removed, bt[:rig - 0.7sw] >> 0.5mt);
        slabel(:left :removed, bt[:rig - 0.5sw] >> 0.5mt >> 1.4sh, "Vedsted");
    }

    with link = "point.dk.Hviding-Grænse", railway = :station {
        track(bt[:rig - 0.2sw, :hvt - 0.5sw]);
        marker(:left :de.dirgr :removed, bt[:rig] << 0.5mt);
    }

    with link = "point.dk.Hviding", railway = :station {
        track(bt[:hvt - 0.5sw, :hvt + 0.5sw]);
        marker(:right :de.hp, bt[:hvt] >> 0.5mt);
        marker(:right :de.exbf, bt[:hvt] >> 0.5mt);
        slabel(:left, bt[:hvt + 0.8sw] >> 0.5mt >> 1.8sh, "Hviding");
    }

    with link = "line.dk.BTR" {
        track(bt[:hvt + 0.5sw, :rej - 0.5sw]);
    }

    with link = "point.dk.Rejsby", railway = :station {
        track(bt[:rej - 0.5sw, :rej + 0.5sw]);
        marker(:left :de.hp, bt[:rej] << 0.5mt);
        slabel(:right, bt[:rej + 0.5sw] << 0.5mt << 1.4sh, "Rejsby");
    }

    with link = "line.dk.BTR" {
        track(bt[:rej + 0.5sw, :bro - 0.5sw]);
    }

    with link = "point.dk.Brøns", railway = :station {
        track(bt[:bro - 0.5sw, :bro + 0.5sw]);
        marker(:right :de.hp, bt[:bro] >> 0.5mt);
        slabel(:left, bt[:bro + 0.45sw] >> 0.5mt >> 1.55sh, "Brøns");
    }

    with link = "line.dk.BTR" {
        track(bt[:bro + 0.5sw, :bro + 2km]);
        line_label(:right:e, bt[:bro + 2km] >> 0.5mt, (0dt, 0.2dt), "BTR");
        track(bt[:bro + 2km, :ska.yu]);
    }

    with link = "point.dk.Skærbæk", railway = :station {
        track(bt[:ska.yu, :ska + 0.5sw]);
        marker(:right :de.bf, bt[:ska] >> 0.5mt);
        slabel(:left :bold, bt[:ska + 0.2sw] >> 0.5mt >> 2sh, "Skærbæk");
    }

    with link = "line.dk.BTR" {
        track(bt[:ska + 0.5sw, :dos - 0.5sw]);
    }

    with link = "point.dk.Døstrup-Sønderjylland", railway = :station {
        track(bt[:dos - 0.5sw, :dos + 0.5sw]);
        marker(:right :de.hp, bt[:dos] >> 0.5mt);
        slabel(:left, bt[:dos + 0.45sw] >> 0.5mt >> 1.6sh,
            vbox(:right:topbase, "Døstrup", span(:light, "Sønderjylland"))
        );
    }

    with link = "line.dk.BTR" {
        track(bt[:dos + 0.5sw, :dos + 1.5km]);
        line_label(:left:w, bt[:dos + 1.5km] << 0.5mt, (0dt, -0.1dt), "BTR");
        track(bt[:dos + 1.5km, :bre - 0.5sw]);
    }

    with link = "point.dk.Bredebro", railway = :station {
        track(bt[:bre - 0.5sw, :bre.yr]);
        marker(:left :de.bf, bt[:bre] << 0.5mt);
        slabel(:right :bold, bt[:bre + 0.45sw] << 0.5mt << 1.8sh, "Bredebro");
    }

    with link = "line.dk.BTR" {
        track(bt[:bre.yr, :vis - 0.5sw]);
    }

    with link = "point.dk.Visby", railway = :station {
        track(bt[:vis - 0.5sw, :vis + 0.5sw]);
        marker(:right :de.hp, bt[:vis] >> 0.5mt);
        slabel(:left, bt[:vis + 0.35sw] >> 0.5mt >> 1.5sh, "Visby");
    }

    with link = "line.dk.BTR" {
        track(bt[:vis + 0.5sw, :vis + 5km]);
        line_label(:left:sw, bt[:vis + 5km] << 0.5mt, "BTR");
        track(bt[:vis + 5km, :tin - 0.3sw]);
    }

    with link = "point.dk.Tønder-Industrispor-Nord", railway = :station {
        track(bt[:tin - 0.3sw, :tin + 0.3sw]);
        marker(:left :de.anst, bt[:tin] << 0.5mt);
        slabel(:left :xsmall, bt[:tin + 0.2sw] >> 0.5mt >> 2dt,
            "T. Industrispor Nord"
        );
    }

    with link = "line.dk.BTR" {
        track(bt[:tin + 0.3sw, :ton.yh]);
        track(:ror, bt[:ton.yh, :trn - 0.5sw]);
    }

    with link = "point.dk.Tønder-Nord", railway = :station {
        track(bt[:trn - 0.5sw, :trn + 0.5sw]);
        marker(:right :de.hp :casing, bt[:trn] >> 0.5mt);
        slabel(:left, bt[:trn] >> 0.5mt >> 1.6sh + (0dt, 1dt), "Tønder Nord");
    }

    with link = "line.dk.BTR" {
        track(:ror, bt[:trn + 0.5sw, :ton.yt]);
    }

    with link = "point.dk.Tønder", railway = :station {
        track(:removed, bt[:ton.yt, :ton + 300m] >> 1mt >> 1ms);
        track(bt[:ton.yt, :ton + 300m]);
        track(:removed,
                bt[:ton.yt, :ton + 300m - 1dl] << 1mt << 1ms
            --  bt[:ton + 300m, :ton + 0.1dl]
        );
        marker(:left :de.bf, bt[:ton] << 1.5mt << 1ms);
        slabel(:right :bold, bt[:ton] << 1.5mt << 1ms << 1.6sh + (0dt, 1dt),
            "Tønder"
        );
    }

    with link = "line.dk.BTR" {
        track(:up:ldn :removed,
                bt[:ton + 300m, :ton + 301m] >> 1mt >> 1ms
            ..  bt[:ton.zs + 1md, :tog - 2km] >> 0.5md << 0.5mt
        );
        track(:dn:rup,
                bt[:ton + 300m, :ton.xs]
            ..  bt[:ton.zs + 1md, :tog - 2km] << 0.5md >> 0.5mt
        );
        line_label(:left:w, bt[:tog - 2km] << 0.5md, "BTR");
        track(:up:ldn :removed,
                bt[:tog - 2km, :tog - 0.3sw] >> 0.5md << 0.5mt
        );
        track(:dn:rup, bt[:tog - 2km, :tog - 0.3sw] << 0.5md >> 0.5mt);
    }
}

