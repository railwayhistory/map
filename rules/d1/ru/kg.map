with detail = 1 {
    with link = "line.ru.kg.1" {
        track(:first :double, path("simple.ru.kg.1")[:kal, :gr]);
    }

    with link = "line.ru.kg.2" {
        track(:first :double, path("simple.ru.kg.2")[:kal, :gr]);
    }

    with link = "line.ru.kg.3" {
        track(:first, path("simple.ru.kg.3")[:abal, :f]);
    }

    with link = "line.ru.kg.4", layer = -1 {
        track(:first :removed, path("simple.ru.kg.4")[:gr, :per]);
    }

    with link = "line.ru.kg.5" {
        let kalbag = path("simple.ru.kg.5");
        track(:first, kalbag[:abag, :bag]);
        with layer = -1 track(:first :closed, kalbag[:bag, :gr]);
    }

    with link = "line.ru.kg.6" {
        track(:second :cat, path("simple.ru.kg.6.1")[:asel, :sel]);
        track(:second :cat, path("simple.ru.kg.6.2")[:fswe, :swe]);
    }

    with link = "line.ru.kg.7" {
        track(:first,
                path("simple.ru.kg.2")[:asow - 1m, :asow]
            ..  path("simple.ru.kg.7")[:ftja, :gr]
        );
    }

    with link = "line.ru.kg.8" {
        track(:first :double, path("simple.ru.kg.8")[:akal, :gr]);
    }

    with link = "line.ru.kg.20" {
        let swepri = path("simple.ru.kg.20");
        track(:second :cat, swepri[:swe, :apri]);
        with layer = -1 track(:second :closed, swepri[:apri, :akal]);
    }

    with link = "line.ru.kg.21" {
        track(:second, path("simple.ru.kg.21")[:asow, :fkal]);
    }

    with link = "line.ru.kg.33" {
        track(:second :cat, path("simple.ru.kg.33")[:apri, :sw2]);
    }

    with layer = 2 slabel(
        :right, path("simple.ru.kg.1")[:kal] + (1.5dt, -0.5dt), "Калининград"
    );
}
