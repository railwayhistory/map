# GB HL.  Stanley Junction - Inverness (Highland Line)
#
let hl = path("d4.gb.hl");

with detail = [4, 5] {
    

    with link = "point.gb.Millburn-Jn" {
        marker(:left :statdt, hl[:mil] << 0.5dt);
        marker(:left :de.abzw, hl[:mil] << 1.5dt);

        station(:bottom, hl[:mil] << 1.5dt << 1.2sh + (1.5sw, 0dt),
            span(:bold, "Millburn Jn"),
            hbox(:center:top,
                vbox(:right:top, "HL: ", "??: "),
                vbox(:right:top, "117 ", "143 "),
                vbox(:left:top, "37", "39")
            )
        );
    }

    with link = "point.gb.Welshs-Bridge" {
        marker(:right :de.abzw, hl[:wel] >> 0.5dt);
    }

    with link = "point.gb.Rose-Street-Jn" {
        marker(:right :de.abzw, path("d4.gb.wck")[:ros + 3dt]);
    }

    with link = "point.gb.Inverness" {
        let wk = path("d4.gb.wck");

        # Down North
        track(:first:station :pax,
                wk[:inv.aw - 49m, :inv.aw - 50m]
            ..  wk[:inv.aw - 130m, :ros + 3dt] >> 1dt
            ..  wk[:inv.yw, :inv.yw - 0.1dl] >> 5.5dt
        );

        # Platform 6
        track(:first:station :pax,
                wk[:ros + 3.1dt, :ros + 3dt]
            ..  wk[:inv.yw, :inv] >> 4.5dt
        );


        # Up North
        track(:first:station :pax,
                wk[:inv.aw, :ros + 3dt]
            ..  wk[:inv.yw, :inv] >> 3.5dt
        );
            track(:station,
                    wk[:ros + 3dt]
                --  wk[:ros + 3dt + 60m] << 1dt
            );

        # Ross-shire sdg
        track(:station,
                hl[:inv - 221m, :inv - 220m] >> 1.5dt
            ..  hl[:inv - 160m, :inv] >> 2.5dt
        );
            track(:station,
                    hl[:inv - 161m, :inv - 160m] >> 2.5dt
                ..  hl[:inv - 80m, :inv.yw] >> 3.5dt
            );

        # Platform 4
        track(:station :pax,
                hl[:wel + 109m, :wel + 110m] >> 0.5dt
            ..  hl[:wel + 200m, :inv] >> 1.5dt
        );

        # Up Line
        track(:first:station :pax, hl[:inv.ap, :inv] >> 0.5dt);

        # Down Line
        track(:first:station :pax, hl[:inv.ap, :inv] << 0.5dt);
            track(:station,
                    hl[:wel - 100m] << 0.5dt
                --  hl[:wel - 30m] << 1.5dt
            );

        # East Line
        track(:first:station :pax,
                hl[:mil.y, :mil - 100m] << 1.5dt
            ..  hl[:mil + 30m, :mil + 31m] << 0.5dt
        );

        # Platform 1
        track(:station :pax,
                hl[:wel + 59m, :wel + 60m] << 0.5dt
            ..  hl[:wel + 180m, :inv] << 1.5dt
        );

        # Sdg
        track(:station,
                hl[:wel - 220m, :wel - 30m] << 1.5dt
            ..  hl[:wel + 180m, :inv - 75m] << 2.5dt
        );


        # Platform 1/2
        platform(:pax,
                hl[:wel + 180m, :inv] << 0.5dt
            --  hl[:inv, :wel + 180m] >> 1.5dt
        );

        # Platform 3/4
        platform(:pax,
                hl[:inv - 180m, :inv] >> 0.5dt
            --  hl[:inv, :inv - 180m] << 1.5dt
        );

        # Platform 5/6
        platform(:pax,
                hl[:inv.yw, :inv] >> 3.5dt
            --  hl[:inv, :inv.yw] << 4.5dt
        );

        marker(:top :de.bf :pax, hl[:inv] >> 2dt);
        station(:left :pax, hl[:inv] + (-0.5sw, 1.9sh),
            span(:large :bold, "Inverness"),
            hbox(:center:top,
                vbox(:right:top, "WCK: ", "HL: "),
                vbox(:right:top, "0 ", "118 "),
                vbox(:left:top, "02", "03")
            )
        );
    }
}

