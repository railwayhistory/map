# GB BAF.  Ballinluig - Aberfeldy
#
let ba = path("d4.gb.baf");

with detail = [4, 5] {
    # point.gb.Ballinluig: gb.HL

    with link = "line.gb.BAF" {
        track(:first :removed, ba[:bal.fa, :bag - 100m]);
        line_badge(:removed, ba[:bag - 1.25km], "BAF");
    }

    with link = "point.gb.Balnaguard" {
        track(:first:station :removed, ba[:bag - 100m, :bag + 100m]);
        platform(:removed,
                ba[:bag - 30m, :bag + 30m]
            --  ba[:bag + 30m, :bag - 30m] << 0.7dt
        );
        marker(:right :de.hp :removed, ba[:bag] >> 0.5dt);
        station(:top :removed, ba[:bag - 0.1sw] >> 0.5dt >> 1.2sh,
            "Balnaguard", "??"
        );
    }

    with link = "line.gb.BAF" {
        track(:first :removed, ba[:bag + 100m, :gra - 270m]);
    }

    with link = "point.gb.Grandtully" {
        track(:first:station :removed, ba[:gra - 270m, :gra + 100m]);
        track(:station :removed, ba[:gra - 180m, :gra - 40m] >> 1dt);
        track(:station :removed,
                ba[:gra - 221m, :gra - 220m]
            --  ba[:gra - 140m, :gra - 75m] >> 2dt
        );

        platform(:removed,
                ba[:gra - 40m, :gra + 30m]
            --  ba[:gra + 30m, :gra - 40m] << 0.7dt
        );
        marker(:right :de.bf :removed, ba[:gra] >> 2dt);
        station(:top :removed, ba[:gra + 0.1sw] >> 2dt >> 1.2sh,
            "Grandtully", "??"
        );
    }

    with link = "line.gb.BAF" {
        track(:first :removed, ba[:gra + 100m, :abd - 220m]);
    }

    with link = "point.gb.Aberfeldy-Distillery" {
        track(:station :removed,
                ba[:abd - 170m, :abd - 40m] << 2dt
            --  ba[:abd + 40m, :abd + 41m]
        );
        track(:station :removed, ba[:abd - 170m, :abd + 40m] << 1dt);
        track(:first:station :removed, ba[:abd - 220m, :abd + 90m]);
        marker(:right :de.anst :removed, ba[:abd]);
        station(:right :removed, ba[:abd - 0.2sw] << 1.6sh,
            "Aberfeldy Distillery", "??"
        );
    }

    with link = "line.gb.BAF" {
        track(:first :removed, ba[:abd + 90m, :abe - 350m]);
        line_badge(:removed, ba[:abd - 1.85km], "BAF");
    }

    with link = "point.gb.Aberfeldy" {
        track(:station :removed,
                ba[:abe - 200m, :abe - 180m] << 2dt
            --  ba[:abe - 140m, :abe - 139m] << 1dt
        );
        track(:station :removed, ba[:abe - 200m, :abe + 80m] << 1dt);
        track(:first:station :removed, ba[:abe - 350m, :abe + 80m]);
            track(:station :removed,
                    ba[:abe - 180m]
                --  ba[:abe - 110m] << 1dt
            );
        track(:station :removed,
                ba[:abe - 260m, :abe - 140m] >> 1dt
            ..  ba[:abe - 70m, :abe - 20m] >> 1.2dt
        );
            track(:station :removed,
                    ba[:abe - 140m] >> 1dt
                --  ba[:abe - 80m]
            );
        track(:station :removed, ba[:abe - 220m, :abe - 80m] >> 2dt);
        track(:station :removed, ba[:abe - 180m, :abe - 20m] >> 3dt);
        track(:station :removed,
                ba[:abe - 301m, :abe - 300m]
            --  ba[:abe - 140m, :abe - 20m] >> 4dt
        );

        platform(:removed,
                ba[:abe - 70m, :abe + 80m]
            --  ba[:abe + 80m, :abe - 70m] << 0.7dt
        );

        marker(:right :de.bf :removed, ba[:abe] >> 4dt);
        station(:left :removed, ba[:abe + 0.5sw] >> 4dt >> 1.2sh,
            span(:bold, "Aberfeldy"), "BAF: ??"
        );
    }
}

