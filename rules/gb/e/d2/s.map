# GB SAH.  Hatfield - St Albans Abbey
with detail = 2 {
    let sah = path("d2.gb.sah");

    with link = "line.gb.SAH" {
        track(:first :removed, sah[:hat.ys, :saa.y]);

        guide(:linenum :removed,
                sah[:hat.ys + 4.5km] >> 0.7dt
            --  sah[:hat.ys + 4.5km] >> 3.0dt
        );
        label(:linenum :removed, sah[:hat.ys + 4.5km] >> 3.0dt,
            hbox(:center:bottom, "SAH")
        );
    }
}


# SBR.  Hitchin - Shepreth Branch Junction.
with detail = 2 {
    let sbr = path("d2.gb.sbr");

    with link = "line.gb.SBR" {
        track(:first :double :cat:ac25 :pax, sbr[:hit.ys, :sbj]);
        line_badge(:cat:ac25 :pax, sbr[:hit.ys + 15.5km] << 0.2dt, "SBR");
    }
}


# GB SCH1.  Woodville Goods Junction - Swadlincote Junction
with detail = 2 {
    let sch1 = path("d2.gb.sch1");

    with link = "line.gb.SCH1" {
        track(:first :removed, sch1[:wgj, :swj]);

        guide(:linenum :removed,
                sch1[:swj - 5km] >> 0.7dt
            --  sch1[:swj - 5km] >> 3.0dt
        );
        label(:linenum :removed, sch1[:swj - 5km] >> 3.0dt,
            hbox(:center:bottom, "SCH1")
        );
    }
}


# GB SCH2.  Woodville Junction - Woodville Goods Junction
with detail = 2 {
    let sch2 = path("d2.gb.sch2");

    with link = "line.gb.SCH2" {
        track(:first :removed, sch2[:woj, :wgj]);
    }
}


# SEN.  Syston East Junction - Syston North Junction
with detail = 2 {
    with link = "line.gb.SEN" {
        track(:first :double :pax, path("d2.gb.sen")[:sej, :snj]);
    }
}


# SEU.  Seaton - Uppingham
with detail = 2 {
    let seu = path("d2.gb.seu");

    with link = "line.gb.SEU" {
        track(:first :removed, seu[:sea.yu, :upp]);
    
        guide(:linenum :removed,
                seu[:upp - 1.5km] << 0.7dt
            --  seu[:upp - 1.5km] << 3.0dt
        );
        label(:linenum :removed, seu[:upp - 1.5km] << 3.0dt + (-1dt, 0dt),
            hbox(:center:top, "SEU")
        );
    }

    with link = "point.gb.Uppingham" {
        with layer = 1 marker(:statdot :removed, seu[:upp]);
        slabel(:left :removed, seu[:upp] + (4dt, -1.5dt), "Uppingham");
    }
}


# SIB.  Chesterton Junction - Huntingdon.
with detail = 2 {
    let sib = path("d2.gb.sib");

    with link = "line.gb.SIB" {
        track(:first :double :removed, sib[:cam.yh, :siv]);
        track(:first :removed, sib[:siv, :hun.yc]);

        line_badge(:removed, sib[:siv - 7.5km], "SIB");
        line_badge(:removed, sib[:siv + 5km], "SIB");
    }

    with link = "point.gb.St-Ives" {
        with layer = 1 marker(:statdot :removed, sib[:siv]);
        slabel(:left :removed, sib[:siv] + (0dt, 0.8dt),
            hbox(:right:top, "St Ives")
        );
    }
}


# SIE.  St Ives - Sutton Branch Junction (Ely)
with detail = 2 {
    let sie = path("d2.gb.sie");

    with link = "line.de.SIE" {
        track(:first :double :removed, sie[:siv, :nej]);
        track(:first :removed, sie[:nej, :sbj]);

        line_badge(:removed, sie[:nej + 9km], "SIE");
    }
}


# SOR.  Somersham - Ramsey East
with detail = 2 {
    let sor = path("d2.gb.sor");

    with link = "line.de.SOR" {
        track(:first :removed, sor[:som.yr, :ram]);
        line_badge(:removed, sor[:ram - 5.3km] >> 0.3dt, "SOR");
    }

    with link = "point.gb.Ramsey-East" {
        with layer = 1 marker(:statdot :removed, sor[:ram]);
        slabel(:right :removed, sor[:ram] + (1.3dt, -0.5dt), "Ramsey");
    }
}


# SPB.  Sproxton Branch
with detail = 2 {
    let spb = path("d2.gb.spb");

    with link = "line.gb.SPB" {
        track(:first :removed, spb[:skj.y, :spr]);
        guide(:linenum :removed,
                spb[:skj.y + 3km] << 0.7dt
            --  spb[:skj.y + 3km] << 3.0dt
        );
        label(:linenum :removed, spb[:skj.y + 3km] << 3.0dt,
            hbox(:center:top, "SPB")
        );
    }
}


# GB SPC1.  St Pancras - Bedford
with detail = 2 {
    let spc1 = path("d2.gb.1.spc1");

    with link = "line.gb.SPC1" {
        track(:first :double :cat:ac25 :pax, spc1[:sal, :bed]);
        line_badge(:cat:ac25 :pax, spc1[:lut + 10.2km] << 0.1dt, "SPC1");
    }

    with link = "point.gb.Luton" {
        with layer = 1 marker(:statdot :cat:ac25 :pax, spc1[:lut]);
        slabel(:right :cat:ac25 :pax, spc1[:lut] + (-0.5dt, -1.5dt), "Luton");
    }

    with link = "point.gb.Bedford" {
        with layer = 1 marker(:statdot :cat:ac25 :pax, spc1[:bed]);
        slabel(:left :cat:ac25 :pax, spc1[:bed] + (-1.8dt, 1.3dt), "Bedford");
    }
}


# GB SPC2.  Bedford - Wellingborough
with detail = 2 {
    let spc2 = path("d2.gb.spc2");

    with link = "line.gb.SPC2" {
        track(:first :double :cat:ac25 :pax, spc2[:bed, :wel]);
        line_badge(:cat:ac25 :pax, spc2[:bed + 8km], "SPC2");
    }
}


# GB SPC3.  Wellingborough - Wigston
with detail = 2 {
    let spc3 = path("d2.gb.spc3");

    with link = "line.gb.SPC3" {
        track(:first :double :cat:ac25 :pax, spc3[:wel, :gls]);
        track(:first :double :pax, spc3[:gls, :wig]);

        line_badge(:cat:ac25 :pax, spc3[:wel + 5km], "SPC3");
        guide(:linenum :pax,
                spc3[:gls + 6km] << 1dt
            --  spc3[:gls + 6km] << 3dt
        );
        label(:linenum :pax, spc3[:gls + 6km] << 3dt + (-0.2dt, 0dt),
            hbox(:center:top, "SPC3")
        );
        line_badge(:pax, spc3[:mha.ys + 5.5km] @ 5 << 0.5dt, "SPC3");
    }

    with link = "point.gb.Wellingborough" {
        with layer = 1 marker(:statdot :cat:ac25 :pax, spc3[:wel]);
        slabel(:left :cat:ac25 :pax, spc3[:wel] + (-1.5dt, 1.0dt),
            "Wellingborough"
        );
    }

    with link = "point.gb.Kettering" {
        with layer = 1 marker(:statdot :cat:ac25 :pax, spc3[:ket]);
        slabel(:right :cat:ac25 :pax, spc3[:ket] + (1.6dt, 0dt),
            "Kettering"
        );
    }

    with link = "point.gb.Market-Harborough" {
        with layer = 1 marker(:statdot :pax, spc3[:mha]);
        slabel(:right :pax, spc3[:mha] + (1.5dt, 1.5dt),
            vbox(:left:bottom, "Market", "Harborough")
        );
    }

    with link = "point.gb.Wigston" {
        with layer = 1 marker(:statdot :removed, spc3[:wig]);
        slabel(:right :removed, spc3[:wig] + (1.5dt, 0.3dt), "Wigston");
    }
}


# GB SPC4.  Wigston - Leicester
with detail = 2 {
    let spc4 = path("d2.gb.spc4");

    with link = "line.gb.SPC4" {
        track(:first :double :pax, spc4[:wig, :lei]);

        guide(:linenum :pax,
                spc4[:wig + 2km] >> 1dt
            --  spc4[:wig + 2km] >> 3dt
        );
        label(:linenum :pax, spc4[:wig + 2km] >> 3dt,
            hbox(:left:middle, " SPC4")
        );
    }
}


# GB SPC5.  Leicester - Ratcliffe Junction
with detail = 2 {
    let spc5 = path("d2.gb.spc5");

    with link = "line.gb.SPC5" {
        track(:first :double :pax, spc5[:lei, :rat]);

        line_badge(:pax, spc5[:sys - 3km], "SPC5");
        line_badge(:pax, spc5[:lou + 5km] @ 5 >> 0.2dt, "SPC5");
    }

    with link = "point.gb.Leicester" {
        with layer = 1 marker(:statdot :pax, spc5[:lei]);
        slabel(:right :pax, spc5[:lei] + (1.0dt, 3.0dt), 
            span(:bold, "Leicester")
        );
    }

    with link = "point.gb.Syston" {
        with layer = 1 marker(:statdot :pax, spc5[:sys]);
        slabel(:right :pax, spc5[:sys] + (1.5dt, 1.0dt), "Syston");
    }

    with link = "point.gb.Loughborough" {
        with layer = 1 marker(:statdot :pax, spc5[:lou]);
    }

    with link = "point.gb.East-Midlands-Parkway" {
        with layer = 1 marker(:statdot :pax, spc5[:emp]);
    }
}


# GB SPC6.  Ratcliffe Junction - Derby
with detail = 2 {
    let spc6 = path("d2.gb.spc6");

    with link = "line.gb.SPC6" {
        track(:first :double :pax, spc6[:rat, :spj]);
        track(:first :double :removed, spc6[:spj, :cha]);
        track(:first :double, spc6[:cha, :dej]);

        guide(:linenum :pax,
                spc6[:spo - 3km] << 1dt
            --  spc6[:spo - 3km] << 3dt
        );
        label(:linenum :pax, spc6[:spo - 3km] << 3dt,
            hbox(:center:top, "SPC6")
        );
    }

    with link = "point.gb.Long-Eaton" {
        with layer = 1 marker(:statdot :pax, spc6[:lea]);
    }

    with link = "point.gb.Spondon" {
        with layer = 1 marker(:statdot :pax, spc6[:spo]);
        slabel(:right :pax, spc6[:spo] + (0.3dt, -1.3dt), "Spondon");
    }

    with link = "point.gb.Chaddesden" {
        with layer = 1 marker(:statdot, spc6[:cha]);
    }
}


# GB SPC7.  Spondon - Derby London Road Junction
with detail = 2 {
    let spc7 = path("d2.gb.spc7");

    with link = "line.gb.SPC7" {
        track(:first :double :pax, spc7[:spj, :dlr]);
    }
}


# SWD.  Seaton - Yarwell Junction
with detail = 2 {
    let swd = path("d2.gb.swd");

    with link = "line.de.SWD" {
        track(:first :double :removed, swd[:sea.yw, :yar.y]);

        guide(:linenum :removed,
                swd[:sea.yw + 9.3km] >> 1dt
            --  swd[:sea.yw + 9.3km] >> 3dt
        );
        label(:linenum :removed, swd[:sea.yw + 9.3km] >> 3dt,
            hbox(:center:top, "SWD")
        );
    }
}


# GB STI.  Swannington Incline
with detail = 2 {
    with link = "line.gb.STI" {
        track(:first :removed, path("d2.gb.sti")[:mal, :f]);
    }
}


# SYB.  Saxby - Bourne
with detail = 2 {
    let syb = path("d2.gb.syb");

    with link = "line.gb.SYB" {
        track(:first :removed, syb[:sax.yb, :bou.ys]);
        line_badge(:removed, syb[:sax.yb + 12km], "SYB");
    }
}


# SYS.  Bourne - Sutton Bridge Junction
with detail = 2 {
    let sys = path("d2.gb.sys");

    with link = "line.gb.SYS" {
        track(:first :removed, sys[:bou, :sbj.y]);
        line_badge(:removed, sys[:bou + 7km], "SYS");
        line_badge(:removed, sys[:sbj.y - 12km], "SYS");
    }
}

